#! /usr/bin/env node  
!function(r){"use strict";function n(){return st.__string_rec(this,"")}var t,d=d||{};function e(t,e){var i,r=Object.create(t);for(i in e)r[i]=e[i];return e.toString!==Object.prototype.toString&&(r.toString=e.toString),r}function c(){}c.__name__=!0,c.init=function(t){if(H.log("== cdcrush - v 1.5.2"),H.log("== Highly compress cd-image games"),H.log("== ------------------------------------------------- \n"),c.TOOLS_PATH=ut.join(ut.dirname(process.argv[1]),"../tools/"),c.FFMPEG_PATH="",L.LOG=function(t){H.log(t)},c.setTempFolder(t),!new A(c.FFMPEG_PATH).exists())throw Y.thrown("Could not find ffmpeg.exe. Make sure it is set on system/user path")},c.setThreads=function(t){t<1?t=1:8<t&&(t=8),c.MAX_TASKS=t,H.log("== MAX_TASKS = "+c.MAX_TASKS)},c.setTempFolder=function(t){null==t&&(t=ct.tmpdir());var e=ut.join(t,"CDCRUSH_361C4202-25A3-4F09-A690");try{K.createRecursiveDir(e)}catch(t){Z.lastError=t;var i=Y.caught(t).unwrap();if("string"!=typeof i)throw t;var r=i;throw H.log("Can't Create Temp Folder : "+e,4),H.log(r,4),Y.thrown("Can't Create Temp Folder : "+e)}if(!K.hasWriteAccess(e))throw Y.thrown("Don't have write access to Temp Folder : "+e);c.TEMP_FOLDER=e,H.log("+ TEMP FOLDER = "+c.TEMP_FOLDER)},c.checkCreateUniqueOutput=function(e,i){null==i&&(i="");var r="";try{r=ut.join(e,i)}catch(t){throw Z.lastError=t,Y.caught(t).unwrap()instanceof Error?Y.thrown("Can`t join paths ("+e+" + "+i+")"):t}for(;K.pathExists(r);)r+="_",H.log("! OutputFolder Exists, new name: "+r);try{K.createRecursiveDir(r)}catch(t){throw Z.lastError=t,"string"==typeof Y.caught(t).unwrap()?Y.thrown("Can't create "+r):t}return r},c.checkFileQuick=function(t,e){if(!K.pathExists(t))throw Y.thrown("File does not exist "+t);if(e.indexOf(ut.extname(t).toLowerCase())<0)throw Y.thrown("File, not valid extension "+t)},c.getSubTempDir=function(){return ut.join(c.TEMP_FOLDER,g.substr(q.getGUID(),0,12))};function p(t,e,i){null==i&&(i=!0),null==e&&(e=!1),this.FLAG_ERROR_DETAIL=!0,this.headerLen=0,this.T=l.TERMINAL,this.flag_multiple_progress=e,this.flag_print_header=i,this.slotCursorJump=[],(this.job=t).events.on("jobStatus",gt(this,this.onJobStatus)),1==t.MAX_CONCURRENT&&this.flag_multiple_progress&&(this.flag_multiple_progress=!1),t.status!=G.waiting&&this.onJobStatus(G.start,t)}p.__name__=!0,p.prototype={onJobStatus:function(t,e){switch(t._hx_index){case 1:this.doCompleteJob(!0);break;case 3:var i,r,n,s;this.flag_print_header&&(o=this.T,process.stdout.write("[0m"),this.T.cursorHide(),this.T.pageDown(this.job.MAX_CONCURRENT+2),u=null!=e.info?(i=e.info,this.headerLen=e.info.length,r=i.indexOf("["),n=i.lastIndexOf("]"),0<=r&&0<=n&&((s=i.split(""))[r]="~yellow~",s[n]="~!.~",i=s.join("")),(o=this.T).sprintf(p.PREFIX_HED+i)):(this.headerLen=e.sid.length,(o=this.T).sprintf(p.PREFIX_HED+e.sid)),process.stdout.write(u),process.stdout.write("\n"));var o=this.T;process.stdout.write("[s"),null!=this.onStart&&this.onStart(e),this.timeLastProgUpdate=0,this.printSynopticInit();break;case 5:this.doCompleteJob(!1);break;case 6:this.flag_multiple_progress&&(this.gotoTaskLine(e.TASK_LAST),o=this.T,null==(h=this.slotCursorJump[e.TASK_LAST.SLOT])&&(h=1),process.stdout.write("["+h+"C"),this.printPercent(e.TASK_LAST.PROGRESS));var a=process.uptime();if(a-this.timeLastProgUpdate<p.UPDATE_MIN_TIME)return;this.timeLastProgUpdate=a,this.printSynopticProgress();break;case 7:var l=e.TASK_LAST;if(l.FLAG_PROGRESS_DISABLE)return;var c=l.info;if(this.flag_multiple_progress){this.gotoTaskLine(l);var u=(o=this.T).sprintf(p.PREFIX_TWO+c+" ~darkgray~..~!.~");return process.stdout.write(u),void(this.slotCursorJump[l.SLOT]=7+c.length)}var h,o=this.T;process.stdout.write("[u"),null==(h=2)&&(h=1),process.stdout.write("["+h+"B"),o.clearLine();u=(o=this.T).sprintf(p.PREFIX_TWO+c);process.stdout.write(u);process.stdout.write("[39m");break;case 8:this.timeLastProgUpdate=0,this.printSynopticProgress(),this.flag_multiple_progress&&(this.gotoTaskLine(e.TASK_LAST),this.T.clearLine())}},printSynopticInit:function(){this.T.pageDown(2);var t=this.T.sprintf(p.PREFIX_ONE+"Tasks Completed :\n");process.stdout.write(t);t=this.T.sprintf(p.PREFIX_ONE+"Total Progress  :\n");process.stdout.write(t),this.jobCursorJump=21},printSynopticProgress:function(){this.T;process.stdout.write("[u");var t=this.jobCursorJump;null==t&&(t=1),process.stdout.write("["+t+"C");var e=this.T.sprintf("~yellow~"+this.job.TASKS_P_COMPLETE+"/"+this.job.TASKS_P_TOTAL);process.stdout.write(e);this.T;process.stdout.write("[u"),process.stdout.write("[1B");null==(t=this.jobCursorJump)&&(t=1),process.stdout.write("["+t+"C"),this.T.fg(p.PROGRESS_BAR_COL),Q.print(p.PROGRESS_BAR_LEN,0|this.job.PROGRESS_TOTAL);this.T;process.stdout.write("[39m"),this.printPercent(this.job.PROGRESS_TOTAL,!0)},gotoTaskLine:function(t){this.T;process.stdout.write("[u"),process.stdout.write("[1B");process.stdout.write("[1B");for(var e=0,i=t.SLOT;e<i;){e++,this.T;process.stdout.write("[1B")}},printPercent:function(t,e){null==e&&(e=!1);var i,r=this.T;process.stdout.write("["),r.fg("yellow"),e?(r=this.T,i=S.string(Math.round(10*t)/10),process.stdout.write(i)):(r=this.T,process.stdout.write(null==t?"null":""+t));r=this.T;process.stdout.write("%"),process.stdout.write("[39m");process.stdout.write("]   ")},doCompleteJob:function(t){this.T;process.stdout.write("[u"),this.T.cursorShow();this.T;var e=0;null==e&&(e=1),process.stdout.write("["+e+"A");var i;null==(e=this.headerLen+1)&&(e=1),process.stdout.write("["+e+"C"),this.T.clearScreen(0),this.flag_print_header&&(this.T,process.stdout.write(" : "),t?(this.T.fg("green"),process.stdout.write("[Complete]\n"),process.stdout.write("[39m"),null!=this.onComplete&&this.onComplete(this.job)):(this.T.fg("red"),process.stdout.write("[Failed] "),this.FLAG_ERROR_DETAIL&&(this.T.fg("darkgray"),this.T,i=this.job.ERROR,process.stdout.write(i)),this.T,process.stdout.write("[39m"),process.stdout.write("\n")))}};function _(){}_.__name__=!0,_.getArchiver=function(t){return new("ARC"==t?F:C)(c.TOOLS_PATH)},_.getArchiverByExt=function(t){for(var e=et.kvIterator(_.arc.h);e.hasNext();){var i=e.next(),r=i.key;if(i.value.ext==t.toLowerCase())return _.getArchiver(r)}return null},_.getArcExt=function(t){return _.arc.h[t].ext},_.getArchiverStr=function(t){return _.arc.h[t.id].cStr[t.q]},_.getArchiverInfo=function(t){return _.arc.h[t.id].name+" "+["low","medium","high"][t.q]},_.getAudioQualityInfo=function(t){var e=_.audio.h[t.id];return null==e.qReal?e.name:e.name+" "+e.qName[t.q]+e.p},_.getAudioStr=function(t){var e=_.audio.h[t.id];return null==e.qReal?e.encstr:e.encstr+e.qReal[t.q]},_.getAudioExt=function(t){return _.audio.h[t].ext},_.getAvailableArchivers=function(){for(var t=[],e=et.keysIterator(_.arc.h);e.hasNext();){var i=e.next();t.push(i)}return t},_.getAvailableAudioCodecs=function(){for(var t=[],e=et.keysIterator(_.audio.h);e.hasNext();){var i=e.next();t.push(i)}return t},_.normalizeAudioSettings=function(t){return _.parseCodecTuple(t,_.getAvailableAudioCodecs(),3,2)},_.normalizeArchiverSettings=function(t){return _.parseCodecTuple(t,_.getAvailableArchivers(),2,1)},_.getSettingsTuple=function(t){var e=t.split(":");return{id:e[0],q:S.parseInt(e[1])}},_.parseCodecTuple=function(t,e,i,r){var n=t.split(":");if(0<n.length){var s,o=n[0].toUpperCase();if(-1<e.indexOf(o)){if(s=o+":",null!=n[1]){var a=S.parseInt(n[1]);if(null!=a)return a<0?a=0:i<a&&(a=i),s+a}return s+r}}return null};function f(t,e){this.r=new RegExp(t,e.split("u").join(""))}f.__name__=!0,f.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw Y.thrown("EReg::matched")},matchedPos:function(){if(null==this.r.m)throw Y.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(t,e,i){var r;return null==i&&(i=-1),this.r.global?(this.r.lastIndex=e,this.r.m=this.r.exec(i<0?t:g.substr(t,0,e+i)),(r=null!=this.r.m)&&(this.r.s=t)):(r=this.match(i<0?g.substr(t,e,null):g.substr(t,e,i)))&&(this.r.s=t,this.r.m.index+=e),r},split:function(t){var e="#__delim__#";return t.replace(this.r,e).split(e)},map:function(t,e){for(var i=0,r="";!(i>=t.length);){if(!this.matchSub(t,i)){r+=S.string(g.substr(t,i,null));break}var n=this.matchedPos();if(r+=S.string(g.substr(t,i,n.pos-i)),r+=S.string(e(this)),i=0==n.len?(r+=S.string(g.substr(t,n.pos,1)),n.pos+1):n.pos+n.len,!this.r.global)break}return!this.r.global&&0<i&&i<t.length&&(r+=S.string(g.substr(t,i,null))),r}};var g=function(){};g.__name__=!0,g.dateStr=function(t){var e=t.getMonth()+1,i=t.getDate(),r=t.getHours(),n=t.getMinutes(),s=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(i<10?"0"+i:""+i)+" "+(r<10?"0"+r:""+r)+":"+(n<10?"0"+n:""+n)+":"+(s<10?"0"+s:""+s)},g.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},g.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},g.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},g.now=function(){return Date.now()};function s(t,e){this.fail_info=null,this.TIME_COMPLETE=0,this.taskgen=null,this.IS_KILLED=!1,this.ERROR=null,this.onFail=null,this.onComplete=null,this.MAX_CONCURRENT=2,this.taskQueue=[],this.currentTasks=[],this.taskData=e,this.sid=null==t?"Job:"+g.dateStr(new Date):t,this.status=G.waiting,this.TASKS_RUNNING=0,this.TASKS_COMPLETE=0,this.TASKS_TOTAL=0,this.PROGRESS_TOTAL=0,this.TASKS_P_PRECALC=0,this.TASKS_P_TOTAL=0,this.TASKS_P_COMPLETE=0,this.TASKS_P_RATIO=0,this.events=new ht}s.__name__=!0,s.prototype={addTaskGen:function(e){var i=this,t=new k("Generator Start",function(t){i.taskgen=e,t.complete()});return t.FLAG_PROGRESS_DISABLE=!0,this.add(t)},addT:function(t){return this.TASKS_TOTAL++,t.FLAG_PROGRESS_DISABLE||(this.TASKS_P_TOTAL++,this.TASKS_P_RATIO=1/this.TASKS_P_TOTAL,this.status==G.start&&(this.TASKS_P_PRECALC=100*this.TASKS_P_RATIO*this.TASKS_P_COMPLETE,this.calculateProgress())),this},add:function(t){return this.taskQueue.push(t),this.addT(t)},addNext:function(t){return this.taskQueue.unshift(t),this.addT(t)},addAsync:function(t){return t.async=!0,this.add(t)},addNextAsync:function(t){return t.async=!0,this.addNext(t)},addQ:function(t,e){return this.add(new k(t,e))},addQA:function(t,e){return this.addAsync(new k(t,e))},init:function(){},start:function(){if(this.status!=G.waiting)throw Y.thrown("A CJob object can only run once");null!=s.global_job_status&&this.events.on("jobStatus",s.global_job_status),null!=s.global_task_status&&this.events.on("taskStatus",s.global_task_status),H.log("JOB INIT : "+S.string(this)),this.status=G.init,this.events.emit("jobStatus",this.status,this);var t=process.hrtime();this.timeStart=t[0]+t[1]/1e9;try{this.init()}catch(i){if(Z.lastError=i,(r=Y.caught(i).unwrap())instanceof Error){var e=r;return this.fail(e.message)}if("string"!=typeof r)throw i;e=r;return this.fail(e)}if(0==this.taskQueue.length)return this.fail("No Tasks to run");for(var i=[],r=0,n=this.MAX_CONCURRENT;r<n;){r++;i.push(!1)}this.slots_active=i;for(i=[],r=0,n=this.MAX_CONCURRENT;r<n;){r++;i.push(-1)}return this.slots_progress=i,H.log("JOB START : "+S.string(this)+", Parallel:("+this.MAX_CONCURRENT+")"),this.status=G.start,this.events.emit("jobStatus",this.status,this),this.feedQueue(),this},feedQueue:function(){var t,e,i=this;if(null!=this.taskgen&&this.currentTasks.length<this.MAX_CONCURRENT)return null==(t=this.taskgen())?this.taskgen=null:(t.async=!0,this.startNextTask(t)),void this.feedQueue();0<this.taskQueue.length?(t=this.taskQueue[0],this.currentTasks.length<this.MAX_CONCURRENT&&(t.async?(this.startNextTask(),this.feedQueue()):0==this.currentTasks.length&&this.startNextTask())):0==this.currentTasks.length&&(e=process.hrtime(),this.TIME_COMPLETE=Math.round(1e3*(e[0]+e[1]/1e9-this.timeStart))/1e3,H.log("JOB COMPLETE : "+S.string(this)+" : Time:"+this.TIME_COMPLETE+"s"),this.status=G.complete,this.events.emit("jobStatus",this.status,this),null==this.queueNext&&this.events.emit("jobStatus",G.allcomplete,this),this.kill(),process.nextTick(function(){null!=i.onComplete&&i.onComplete(),null!=i.queueNext&&i.queueNext.start()}))},startNextTask:function(t){var r=null!=t?t:this.taskQueue.shift();r.parent=this,r.dataGet=this.taskData,r.onStatus=gt(this,this._onTaskStatus),this.currentTasks.push(r);for(var e=0;e<this.slots_active.length&&0!=this.slots_active[e];)++e;this.slots_active[e]=!0,r.SLOT=e,this.TASKS_RUNNING++,s.FLAG_LOG_TASKS&&H.log("Task Start : "+S.string(r)+" <-> "+S.string(this)+" : "+(null==this.taskgen?"Remaining ("+this.taskQueue.length+"), Running ("+this.currentTasks.length+")":" {taskGen}")),$.delay(function(){try{r.start()}catch(t){Z.lastError=t;var e=Y.caught(t).unwrap();if(e instanceof Error){var i=e;r.fail(i.message,{fileName:"djNode/task/CJob.hx",lineNumber:437,className:"djNode.task.CJob",methodName:"startNextTask"})}else{if("string"!=typeof e)throw t;i=e;r.fail(i,{fileName:"djNode/task/CJob.hx",lineNumber:439,className:"djNode.task.CJob",methodName:"startNextTask"})}}},1)},killTask:function(t){this.TASKS_RUNNING--,this.slots_active[t.SLOT]=!1,this.slots_progress[t.SLOT]=-1,t.FLAG_PROGRESS_DISABLE||(this.TASKS_P_PRECALC+=100*this.TASKS_P_RATIO),g.remove(this.currentTasks,t),t.kill()},calculateProgress:function(){this.PROGRESS_TOTAL=this.TASKS_P_PRECALC;for(var t=0,e=this.MAX_CONCURRENT;t<e;){var i=t++;this.slots_active[i]&&(this.PROGRESS_TOTAL+=this.slots_progress[i]*this.TASKS_P_RATIO)}},_onTaskStatus:function(t,e){switch(t==U.complete&&(this.TASKS_COMPLETE++,e.FLAG_PROGRESS_DISABLE||this.TASKS_P_COMPLETE++),this.events.emit("taskStatus",t,e),t._hx_index){case 1:var i,r;if(s.FLAG_LOG_TASKS&&(i=process.hrtime(),r=Math.round(1e3*(i[0]+i[1]/1e9-e.timeStart))/1e3,H.log("Task Complete : "+S.string(e)+", Time:"+r+"s")),this.taskData=e.dataSend,this.TASK_LAST=e,this.killTask(e),this.status==G.fail)return;if(this.status==G.complete)return void H.log("WARNING - Task complete on an already completed CJOB | "+S.string(e));this.events.emit("jobStatus",G.taskEnd,this),this.feedQueue();break;case 2:this.TASK_LAST=e,this.events.emit("jobStatus",G.taskStart,this);break;case 3:s.FLAG_LOG_TASKS&&H.log("Task Fail : "+S.string(e),3),this.fail_info="Task: "+S.string(e),this.killTask(e),this.fail(e.ERROR);break;case 4:this.TASK_LAST=e,this.slots_progress[e.SLOT]=e.PROGRESS,this.calculateProgress(),this.events.emit("jobStatus",G.progress,this)}},fail:function(t){null==t&&(t="");var e=this;return this.status==G.fail?H.log("JOB FAIL Request: Already Failed : "+S.string(this)):(this.ERROR=t,H.log("JOB FAIL : "+S.string(this)),null!=this.fail_info&&H.log("    from : "+this.fail_info),H.log("   error : "+this.ERROR+" : "+B.getExStackThrownInfo()),this.taskgen=null,this.status=G.fail,this.events.emit("jobStatus",this.status,this),this.kill(),null!=this.onFail&&$.delay(function(){e.onFail(e.ERROR)},1)),this},kill:function(){if(!this.IS_KILLED){this.IS_KILLED=!0,this.events.removeAllListeners();for(var t=0,e=this.currentTasks;t<e.length;){var i=e[t];++t,i.kill()}for(t=0,e=this.taskQueue;t<e.length;){i=e[t];++t,i.kill()}H.log("JOB KILLED : "+S.string(this))}},toString:function(){return"JOB ["+this.sid+"] "+(null!=this.info?this.info:"")},then:function(t){return this.queueNext=t}};function o(t){this.original_size=0,this.final_size=0,s.call(this),this.p=t;var e=ut.basename(t.inputFile);null==this.p.flag_convert_only&&(this.p.flag_convert_only=!1),this.p.flag_convert_only?(this.sid="convert",this.info="Converting : ["+e+"]"):(this.sid="crush",this.info="Crushing : ["+e+"]")}o.__name__=!0,o.__super__=s,o.prototype=e(s.prototype,{init:function(){var t,e,n=this;this.AC=_.getSettingsTuple(this.p.ac),this.DC=_.getSettingsTuple(this.p.dc),this.tempDir=c.getSubTempDir(),c.checkFileQuick(this.p.inputFile,[".cue"]),null!=this.p.outputDir&&0!=this.p.outputDir.length||(this.p.outputDir=ut.dirname(this.p.inputFile)),this.p.flag_convert_only?(t=this.p.outputDir,e=ut.parse(this.p.inputFile).name+" (r)",this.p.outputDir=c.checkCreateUniqueOutput(t,e)):K.createRecursiveDir(this.p.outputDir),K.createRecursiveDir(this.tempDir),H.log("== Creating a CRUSH Job with these parameters :"),H.log(" - Input : "+this.p.inputFile),H.log(" - Output Dir : "+this.p.outputDir),H.log(" - Audio Compression : "+this.p.ac),H.log(" - Archive Compression : "+this.p.dc),H.log(" - Convert Only : "+S.string(this.p.flag_convert_only)),this.addQ("-Reading CUE Data & Preparing",function(t){n.cd=new L,n.cd.cueLoad(n.p.inputFile),n.p.flag_convert_only&&1==n.cd.tracks.length&&n.cd.tracks[0].isData?t.fail("No point in converting. No audio tracks on the cd.",{fileName:"src/JobCrush.hx",lineNumber:107,className:"JobCrush",methodName:"init"}):(n.original_size=n.cd.CD_TOTAL_SIZE,n.cd.CD_AUDIO_QUALITY=_.getAudioQualityInfo(n.AC),t.complete())}),this.add(new v),this.addQ("-Preparing to Compress",function(t){for(var e=0,i=n.cd.tracks;e<i.length;){var r=i[e];++e,n.p.flag_convert_only&&r.isData||n.addNextAsync(new w(r))}t.complete()}),this.p.flag_convert_only?this._addTasksConvert():this._addTasksCrush(),this.addQ(null,function(t){var e;H.log("== Detailed CD INFOS:\n"+n.cd.getDetailedInfo()),null!=n.nfoFile&&(e=n.cd.getDetailedInfo(),e+="\n"+n.nfoFileData+"\n\n; CDCRUSH (nodejs) version : 1.5.2",lt.writeFileSync(n.nfoFile,e)),t.complete()})},_addTasksConvert:function(){var a=this;this.addQ("Finalizing",function(t){for(var e,i=Math.ceil(100/a.cd.tracks.length),r=0,n=a.cd.tracks;r<n.length;){var s=n[r];++r,a.cd.MULTIFILE||s.rewriteIndexes_forMultiFile();var o=ut.extname(s.workingFile);a.final_size+=lt.statSync(s.workingFile).size,s.trackFile=a.cd.CD_TITLE+" (track "+s.trackNo+")"+o,s.isData&&!a.flag_tracksOnTempFolder?K.copyFileSync(s.workingFile,ut.join(a.p.outputDir,s.trackFile)):K.moveFile(s.workingFile,ut.join(a.p.outputDir,s.trackFile)),t.set_PROGRESS(t.PROGRESS+i)}a.convertedCuePath=ut.join(a.p.outputDir,a.cd.CD_TITLE+".cue"),a.cd.cueSave(a.convertedCuePath,["CDCRUSH (nodejs) version : 1.5.2","https://github.com/john32b/cdcrush"]),c.FLAG_NFO&&(e=K.getPathNoExt(a.convertedCuePath)+" (cdcrush)",a.nfoFile=e+".txt",a.nfoFileData="Converted to CUE/Encoded Audio Tracks"),t.complete()})},_addTasksCrush:function(){var u,h=this;this.addQ("Creating Archive",function(t){var e=h.p.outputDir,i=h.cd.CD_TITLE+_.getArcExt(h.DC.id);for(h.final_arc=ut.join(e,i);K.pathExists(h.final_arc);){H.log(h.final_arc+" already exists, adding (_) until unique",2);var i=K.getPathNoExt(h.final_arc)+"_",r=_.getArcExt(h.DC.id);h.final_arc=i+r}H.log("- Destination Archive :"+h.final_arc);for(var n=[],s=0,o=h.cd.tracks;s<o.length;){var a=o[s];++s,n.push(a.workingFile)}var l=n,c=ut.join(h.tempDir,"crushdata.json");h.cd.jsonSave(c),l.push(c),u=_.getArchiver(h.DC.id),t.syncWith(u),t.killExtra=gt(u,u.kill),u.compress(l,h.final_arc,_.getArchiverStr(h.DC))}),this.addQ(null,function(t){var e,i;h.final_size=u.COMPRESSED_SIZE,c.FLAG_NFO&&(e=K.getPathNoExt(h.final_arc)+" (cdcrush)",h.nfoFile=e+".txt",e="Crushed File : "+ut.basename(h.final_arc)+"\nArchive Size : "+q.bytesToMBStr(h.final_size)+"MB\nArchive Compression : ",i=_.getArchiverInfo(h.DC),h.nfoFileData=e+i),t.complete()})},kill:function(){s.prototype.kill.call(this),c.FLAG_KEEP_TEMP||this.tempDir!=this.p.outputDir&&(H.log("Deleting tempdir : "+this.tempDir),K.deleteRecursiveDir(this.tempDir))}});function a(t){this.original_size=0,this.final_size=0,s.call(this,"restore"),this.info="Restoring : ["+ut.basename(t.inputFile)+"]",this.p=t}a.__name__=!0,a.__super__=s,a.prototype=e(s.prototype,{init:function(){var t,e,l=this;this.tempDir=c.getSubTempDir(),c.checkFileQuick(this.p.inputFile,[".zip",".7z",".arc"]),null!=this.p.outputDir&&0!=this.p.outputDir.length||(this.p.outputDir=ut.dirname(this.p.inputFile)),this.p.flag_nosub?K.createRecursiveDir(this.p.outputDir):(t=this.p.outputDir,e=ut.parse(this.p.inputFile).name+" (r)",this.p.outputDir=c.checkCreateUniqueOutput(t,e)),K.createRecursiveDir(this.tempDir),H.log("=== Creating RESTORE job with the following parameters :"),H.log("- Input : "+this.p.inputFile),H.log("- Output Dir : "+this.p.outputDir),H.log("- Force Single bin : "+S.string(this.p.flag_forceSingle)),H.log("- Create subfolder : "+S.string(this.p.flag_nosub)),H.log("- Restore to encoded audio/.cue : "+S.string(this.p.flag_encCue)),this.addQ("Extracting",function(t){var e=_.getArchiverByExt(ut.extname(l.p.inputFile));t.syncWith(e),t.killExtra=gt(e,e.kill),l.original_size=lt.statSync(l.p.inputFile).size,e.extract(l.p.inputFile,l.tempDir)}),this.addQ("-Preparing",function(t){l.cd=new L,l.cd.jsonLoad(ut.join(l.tempDir,"crushdata.json")),l.final_size=l.cd.CD_TOTAL_SIZE;for(var e=0,i=l.cd.tracks;e<i.length;){var r=i[e];++e,l.addNextAsync(new O(r))}t.complete()}),this.p.flag_encCue||this.addQ("-Join Prepare",function(t){!l.p.flag_forceSingle&&l.cd.MULTIFILE||l.addNext(new R),t.complete()}),this.addQ("Moving",function(t){for(var e,i,r=Math.round(100/l.cd.tracks.length),n=0,s=l.cd.tracks;n<s.length;){var o,a=s[n];++n,l.p.flag_encCue?(o=ut.extname(a.workingFile),1==l.cd.tracks.length?a.trackFile=l.cd.CD_TITLE+o:a.trackFile=l.cd.CD_TITLE+" (track "+a.trackNo+")"+o,l.cd.MULTIFILE||a.rewriteIndexes_forMultiFile()):(l.cd.MULTIFILE&&l.p.flag_forceSingle&&a.rewriteIndexes_forSingleFile(),l.cd.MULTIFILE&&!l.p.flag_forceSingle&&(a.trackFile=l.cd.CD_TITLE+" "+a.getFilenameRaw()),l.cd.MULTIFILE&&!l.p.flag_forceSingle||(1==a.trackNo?a.trackFile=l.cd.CD_TITLE+".bin":a.trackFile=null)),null!=a.workingFile&&(K.moveFile(a.workingFile,ut.join(l.p.outputDir,a.trackFile)),t.set_PROGRESS(t.PROGRESS+r))}l.createdCueFile=ut.join(l.p.outputDir,l.cd.CD_TITLE+".cue"),l.cd.cueSave(l.createdCueFile,["CDCRUSH (nodejs) version : 1.5.2","https://github.com/john32b/cdcrush"]),H.log("== Detailed CD INFOS:\n"+l.cd.getDetailedInfo()),c.FLAG_NFO&&(e=K.getPathNoExt(l.createdCueFile)+" (cdcrush).txt",i=l.cd.getDetailedInfo(),i+="\n; CDCRUSH (nodejs) version : 1.5.2",lt.writeFileSync(e,i)),t.complete()})},kill:function(){s.prototype.kill.call(this),c.FLAG_KEEP_TEMP||this.tempDir!=this.p.outputDir&&(H.log("Deleting tempdir "+this.tempDir),K.deleteRecursiveDir(this.tempDir))}});var l=function(){this.argsAction=null,this.argsOptions={},this.argsOutput=null,this.argsInput=[],this.ARGS={inputRule:"opt",outputRule:"opt",requireAction:!1,supportWildcards:!0,supportStrayArgs:!1,helpInput:null,helpOutput:null,helpText:null,Actions:[],Options:[]},this.PROGRAM_INFO={name:"CLI Application",version:"0.1"},this.HELP_MARGIN=12;var i=this;this.set_FLAG_USE_SLASH_FOR_OPTION(!1),H.init(),l.TERMINAL=new j,this.T=l.TERMINAL,process.once("exit",function(t){H.log("==> [EXIT] with code "+t),i.onExit(t)}),process.once("SIGINT",function(){process.exit(1223)}),process.once("uncaughtException",function(t){var e=" ** Uncaught Exception ** \n";t instanceof Error?e+=S.string(t.message):e+=t,i.exitError(e)});try{this.init()}catch(e){if(Z.lastError=e,"string"!=typeof(r=Y.caught(e).unwrap()))throw e;var t=r;this.printBanner(!0),"HELP"==t&&(this.printHelp(),process.exit(0)),this.exitError(t,!0)}H.log("- Inputs : "+this.argsInput.join(", ")),H.log("- Output : "+this.argsOutput),H.log("- Action  set : "+this.argsAction),H.log("- Options set : ");for(var e=0,r=m.fields(this.argsOptions);e<r.length;){var n=r[e];++e,H.log("\t\t"+n+" : "+S.string(m.getProperty(this.argsOptions,n)))}H.log("-------------"),process.nextTick(gt(this,this.onStart))};l.__name__=!0,l.prototype={set_FLAG_USE_SLASH_FOR_OPTION:function(t){return this.FLAG_USE_SLASH_FOR_OPTION=t,this._sb=t?["/","?"]:["-","help"],t},init:function(){this.T;process.stdout.write("[0m"),this.ARGS.Options.unshift(["o","-output","","yes"]);var t=this.PROGRAM_INFO,e=this.ARGS;H.log("Creating Application [ "+t.name+" ,v"+t.version+" ]");for(var i,r=0,n=process.argv.slice(2);null!=(i=n[r++]);)if(i.charAt(0)!=this._sb[0]){var s=this.getArgAction(i);if(null==s)this.argsInput.push(i);else{if(null!=this.argsAction)throw Y.thrown("You can only set one <action>");this.argsAction=s[0]}}else{if(1==i.toLowerCase().indexOf(this._sb[1]))throw Y.thrown("HELP");if(null==(h=this.getArgOption(g.substr(i,1,null))))throw Y.thrown("Illegal argument ["+i+"]");if(null!=h[3]){var o=n[r++];if(null==o||null!=this.getArgOption(o))throw Y.thrown("Argument ["+i+"] requires a parameter");this.argsOptions[h[0]]=o}else this.argsOptions[h[0]]=!0}null!=this.argsOptions.o&&(this.argsOutput=this.argsOptions.o);for(var a,l=0,c=this.argsInput;l<c.length;){var u=c[l];if(++l,0<=u.indexOf("*")){if(1<this.argsInput.length)throw Y.thrown("Multiple Inputs with wildcards are not supported");if(this.argsInput=K.getFileListFromWildcard(u),0==this.argsInput.length)throw Y.thrown("Wildcard `"+u+"` returned 0 files");break}}if(null==this.argsAction&&0<this.argsInput.length&&(null!=(a=this.getArgAction(null,g.substr(ut.extname(this.argsInput[0].toLowerCase()),1,null)))&&(this.argsAction=a[0])),0==this.argsInput.length&&0<=["yes","multi"].indexOf(e.inputRule))throw Y.thrown("Input is required");if(null==this.argsOutput&&"yes"==e.outputRule)throw Y.thrown("Output is required");if(e.requireAction&&null==this.argsAction)throw Y.thrown("Setting an action is required");for(l=0,c=this.ARGS.Options;l<c.length;){var h=c[l];++l,null==h[3]&&(Object.prototype.hasOwnProperty.call(this.argsOptions,h[0])||(this.argsOptions[h[0]]=!1))}},onStart:function(){},onExit:function(t){H.end();this.T;process.stdout.write("[0m"),this.T.cursorShow()},autoCallAction:function(t){null==t&&(t=!1);var e,i=m.field(this,"action_"+this.argsAction);return null!=i&&m.isFunction(i)?(t&&(e=this.T.sprintf("~yellow~+ ~!~Action <~yellow~"+this.getArgAction(this.argsAction)[1]+"~!~>\n"),process.stdout.write(e)),i.apply(this,[])):null},waitKeyQuit:function(){this.T.fg("darkgray");process.stdout.write("\n");process.stdout.write("Press any key to quit.\n");this.T;process.stdout.write("[0m"),M.startCapture(!0,function(t){process.exit(0)})},printHelp:function(){function r(t){return T.lpad(""," ",t)}function t(t){return"opt"==t?"is optional.":"is required."}function e(t){if(null!=t&&0<t.length){var e=new RegExp("(\n)","g".split("u").join("")),i="\n "+r(n.HELP_MARGIN);return t.replace(e,i)}return"..."}var i,n=this,s=this.ARGS,o=this.PROGRAM_INFO;null!=s.helpInput&&(i=new RegExp("(\n)","g".split("u").join("")),s.helpInput="~gray~\t "+s.helpInput.replace(i,"\n\t ")),null!=s.helpOutput&&(i=new RegExp("(\n)","g".split("u").join("")),s.helpOutput="~gray~\t "+s.helpOutput.replace(i,"\n\t "));for(var a=0,l=s.Actions;a<l.length;){var c=l[a];++a,c[2]=e(c[2])}for(a=0,l=s.Options;a<l.length;){c=l[a];++a,c[2]=e(c[2])}var u=(p=this.T).sprintf(" ~green~Program Usage: ~white~ \n");process.stdout.write(u),null==o.executable&&(o.executable="app.js");var h="   "+o.executable+" ";0<s.Actions.length&&(h+="<action> "),0<s.Options.length&&(h+=this._sb[0]+"<option> <parameter> ...\n      "),"no"!=s.inputRule&&(h+="<input> ","multi"==s.inputRule&&(h+="... ")),"no"!=s.outputRule&&(h+=this._sb[0]+"o <output> ");var p=this.T;process.stdout.write(h),process.stdout.write("\n");u=p.sprintf("~darkgray~ ~line2~");process.stdout.write(u);var _=!1;"no"!=s.inputRule&&(_=!0,u=(p=this.T).sprintf("~yellow~ <input> ~!~"),process.stdout.write(u),p=this.T,u=t(s.inputRule),process.stdout.write(u),"multi"==s.inputRule&&(u=(p=this.T).sprintf("~darkcyan~ <multiple supported>"),process.stdout.write(u)),p=this.T,process.stdout.write("\n"),null!=s.helpInput&&(u=(p=this.T).sprintf(s.helpInput),process.stdout.write(u),process.stdout.write("\n"))),"no"!=s.outputRule&&(_=!0,u=(p=this.T).sprintf("~yellow~ <output> ~!~"),process.stdout.write(u),p=this.T,u=t(s.outputRule),process.stdout.write(u),process.stdout.write("\n"),null!=s.helpOutput&&(u=(p=this.T).sprintf(s.helpOutput),process.stdout.write(u),process.stdout.write("\n"))),_&&(u=(p=this.T).sprintf(" ~darkgray~~line2~"),process.stdout.write(u));p=this.T;if(process.stdout.write("[0m"),0<s.Actions.length){var u=(p=this.T).sprintf(" ~magenta~<actions> ~!.~");process.stdout.write(u);u=(p=this.T).sprintf("~darkmagenta~you can set one action at a time ~!~\n");process.stdout.write(u);for(a=0,l=s.Actions;a<l.length;){var d=l[a];++a,"-"!=d[1].charAt(0)&&(u=(p=this.T).sprintf("~white~ "+d[0]+r(this.HELP_MARGIN-d[0].length)+d[1]),process.stdout.write(u),null!=d[3]&&(f=this.T.sprintf("~darkgray~ ~ auto ext:["+d[3]+"]"),process.stdout.write(f)),this.T,process.stdout.write("\n"),g=r(this.HELP_MARGIN),process.stdout.write(g),m=this.T.sprintf("~gray~ "+d[2]+"\n"),process.stdout.write(m),process.stdout.write("[0m"))}}if(0<s.Options.length){u=(p=this.T).sprintf(" ~cyan~<options> ~!.~");process.stdout.write(u);u=(p=this.T).sprintf("~darkcyan~you can set many options~!~\n");process.stdout.write(u);for(a=0,l=s.Options;a<l.length;){var f,g,m,d=l[a];++a,"-"!=d[1].charAt(0)&&(u=(p=this.T).sprintf("~white~ "+this._sb[0]+d[0]+r(this.HELP_MARGIN-d[0].length-1)+d[1]),process.stdout.write(u),null!=d[3]&&(f=this.T.sprintf("~darkgray~ [requires parameter] "),process.stdout.write(f)),this.T,process.stdout.write("\n"),g=r(this.HELP_MARGIN),process.stdout.write(g),m=this.T.sprintf("~gray~ "+d[2]+"\n"),process.stdout.write(m),process.stdout.write("[0m"))}}null!=this.ARGS.helpText&&(p=this.T,process.stdout.write("\n"),p=this.T,u=this.ARGS.helpText+"\n",process.stdout.write(u))},printBanner:function(t){null==t&&(t=!1);var e=this.PROGRAM_INFO;this.T;process.stdout.write("\n");var i=this.T.sprintf("~:cyan~~black~==~!~~cyan~~b~ "+e.name+" ~darkgray~v"+e.version+"~!~");process.stdout.write(i),t?(null!=e.author&&(this.T,i=" by "+e.author,process.stdout.write(i)),this.T,process.stdout.write("\n"),null!=e.info&&(this.T,i=" - "+e.info+"\n",process.stdout.write(i)),null!=e.desc&&(this.T,i=" - "+e.desc+"\n",process.stdout.write(i))):(this.T,process.stdout.write("\n"));i=this.T.sprintf(" ~darkgray~~line~~!~");process.stdout.write(i)},exitError:function(t,e){null==e&&(e=!1);var i=this.T.sprintf("\n~:darkred~~white~ ERROR ~!~ ~red~"+t+"\n");process.stdout.write(i),e&&(i=this.T.sprintf("~darkgray~ ~line2~~yellow~ "+this._sb[0]+this._sb[1]+" ~!~ for usage info\n"),process.stdout.write(i)),H.log(t,4),process.exit(1)},getArgOption:function(t){for(var e=0,i=this.ARGS.Options;e<i.length;){var r=i[e];if(++e,r[0]==t)return r}return null},getArgAction:function(t,e){for(var i=0,r=this.ARGS.Actions;i<r.length;){var n=r[i];if(++i,null!=t&&n[0]==t)return n;if(null!=e&&null!=n[3]&&0<=n[3].split(",").indexOf(e.toLowerCase()))return n}return null},__properties__:{set_FLAG_USE_SLASH_FOR_OPTION:"set_FLAG_USE_SLASH_FOR_OPTION"}};function i(){this.SILENT=!1,l.call(this)}i.__name__=!0,i.main=function(){new i},i.__super__=l,i.prototype=e(l.prototype,{init:function(){this.PROGRAM_INFO.name="cdcrush",this.PROGRAM_INFO.version="1.5.2",this.PROGRAM_INFO.desc="Highly compress cd-image games",this.PROGRAM_INFO.executable="cdcrush",this.PROGRAM_INFO.author="John32B",this.PROGRAM_INFO.info="https://github.com/john32b/cdcrush",this.ARGS.Actions=[["c","crush","Compress a CD image file.","cue"],["r","restore","Restore a compressed CD.","arc,7z,zip"]],this.ARGS.requireAction=!0,this.ARGS.inputRule="multi",this.ARGS.helpInput="Action is determined by input file extension.\nSupports multiple inputs and wildcards (*.cue)",this.ARGS.helpOutput="Specify an output directory (optional)",this.ARGS.Options=[["nosub","No SubFolder","On <Restore>, do not create a subfolder in <output> for the new files"],["enc","Encoded Audio/Cue","<Restore> / <Crush> to encoded audio files/.cue\nIf you specify an archiver with (-dc) files will be put inside an archive."],["merge","Force Single Bin","<Restore> tracks into a single .bin/.cue "],["ac","CODEC:QUALITY , Audio compression for audio tracks","Codecs : flac , opus , vorbis , mp3 , tak : (Defaults to flac)\nQuality : 0 lowest, 1 low, 2 normal, 3 high : (Defaults to 2)\ne.g. -ac flac , -ac opus:0, -ac mp3:3","yes"],["dc","ARCHIVER:Compression , Data compression for final archive","Archivers : 7z , zip , arc : (Defaults to arc)\nCompression : 0 low, 1 normal, 2 high : (Defaults to 1)\ne.g. -dc zip , -dc arc:2","yes"],["th","Threads","Number of maximum threads allowed for operations (1-8) (Default = "+c.MAX_TASKS+")","yes"],["tmp","Temp Folder","Set a custom temp folder for operations","yes"],["nfo","Save Info","Produce an info .txt file next to the produced files\ncontaining general infos, like track MD5 and sizes"],["fork","-Fork","Called as a fork from another nodejs script"]],this.P2=new J(this.T),this.P2.style(0,"yellow"),this.P2.style(1,"cyan"),l.prototype.init.call(this)},onExit:function(t){var e;l.prototype.onExit.call(this,t),1223==t&&(null!=this.job&&this.job.kill(),e=this.T.sprintf("\n~bg_yellow~~black~ - Aborted - ~!~\n"),process.stdout.write(e))},onStart:function(){this.printBanner(),this.SILENT=this.argsOptions.fork;try{c.init(this.argsOptions.tmp)}catch(t){Z.lastError=t;var e=Y.caught(t).unwrap();this.exitError(e)}var t;null!=this.argsOptions.th&&c.setThreads(S.parseInt(this.argsOptions.th)),c.FLAG_NFO=this.argsOptions.nfo,(this.AC=this.DC=null)!=this.argsOptions.ac?(this.AC=_.normalizeAudioSettings(this.argsOptions.ac),null==this.AC&&this.exitError("Invalid Audio Codec String.",!0)):this.AC=_.DEFAULT_AUDIO_PARAM,null!=this.argsOptions.dc?(this.DC=_.normalizeArchiverSettings(this.argsOptions.dc),null==this.DC&&this.exitError("Invalid Archiver String",!0)):this.DC=_.DEFAULT_ARCHIVER_PARAM,this.SILENT||("r"==this.argsAction?(this.P2.print1("Action : {0}",["Restore"]),0<(t=(this.argsOptions.merge?"(Merge) ":"")+(this.argsOptions.nosub?"(No Subfolder) ":"")+(this.argsOptions.enc?"(Encoded Audio) ":"")).length&&this.P2.print1("Flags  : {0}",[t])):"c"==this.argsAction&&(this.argsOptions.enc?this.P2.print1("Action  : {0}",["Convert"]):(this.P2.print1("Action  : {0}",["Crush"]),this.P2.print1("Archive : {0}",[_.getArchiverInfo(_.getSettingsTuple(this.DC))])),this.P2.print1("Audio   : {0}",[_.getAudioQualityInfo(_.getSettingsTuple(this.AC))])),this.argsOptions.nfo&&this.P2.print1("Output  : {0}",[null==this.argsOutput?".(same as source)":this.argsOutput]),this.T.drawLine()),this.do_nextFile()},do_nextFile:function(){var i=this,r=this.argsInput.shift();null==r&&(H.log("[END] - All input files processed"),process.exit(0));var t=null;"r"==this.argsAction?(this.job=new a({inputFile:r,outputDir:this.argsOutput,flag_forceSingle:this.argsOptions.merge,flag_nosub:this.argsOptions.nosub,flag_encCue:this.argsOptions.enc}),t=function(t){var e=i.job;i.P2.print1("  Created : {0}",[e.createdCueFile+" + bins"]),i.P2.print1("  Size : {1} -> {0}",[q.bytesToMBStr(e.original_size)+"MB",q.bytesToMBStr(e.final_size)+"MB"])}):"c"==this.argsAction&&(this.job=new o({inputFile:r,outputDir:this.argsOutput,ac:this.AC,dc:this.DC,flag_convert_only:this.argsOptions.enc}),t=this.argsOptions.enc?function(t){var e=i.job;i.P2.print1("  Created : {0}",[e.convertedCuePath+" + bins"]),i.P2.print1("  Size : {1} -> {0}",[q.bytesToMBStr(e.original_size)+"MB",q.bytesToMBStr(e.final_size)+"MB"])}:function(t){var e=i.job;i.P2.print1("  Created : {0}",[e.final_arc]),i.P2.print1("  Size : {1} -> {0}",[q.bytesToMBStr(e.original_size)+"MB",q.bytesToMBStr(e.final_size)+"MB"])}),this.argsOptions.fork&&this.job.events.on("jobStatus",function(t,e){t!=G.progress?t!=G.start?t==G.complete&&process.send({msg:"complete",file:r,jobID:i.job.sid}):process.send({msg:"start",file:r,jobID:i.job.sid}):process.send({progress:i.job.PROGRESS_TOTAL,msg:"progress"})}),this.SILENT||(new p(this.job,!1,!0).onComplete=t),this.job.MAX_CONCURRENT=c.MAX_TASKS,this.job.onComplete=gt(this,this.do_nextFile),this.job.start()}}),Math.__name__=!0;var m=function(){};m.__name__=!0,m.field=function(t,e){try{return t[e]}catch(t){return Z.lastError=t,null}},m.getProperty=function(t,e){var i;if(null==t)return null;var r=!!t.__properties__&&(i=t.__properties__["get_"+e]);return r?t[i]():t[e]},m.setProperty=function(t,e,i){var r,n=!!t.__properties__&&(r=t.__properties__["set_"+e]);n?t[r](i):t[e]=i},m.fields=function(t){var e=[];if(null!=t){var i,r=Object.prototype.hasOwnProperty;for(i in t)"__id__"!=i&&"hx__closures__"!=i&&r.call(t,i)&&e.push(i)}return e},m.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},m.deleteField=function(t,e){return!!Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],!0)};var S=function(){};S.__name__=!0,S.string=function(t){return st.__string_rec(t,"")},S.parseInt=function(t){if(null!=t)for(var e=0,i=t.length;e<i;){var r=e++,n=t.charCodeAt(r);if(n<=8||14<=n&&32!=n&&45!=n){var s=t.charCodeAt(1+r),o=parseInt(t,120==s||88==s?16:10);return isNaN(o)?null:o}}return null};function u(){this.b=""}u.__name__=!0;var T=function(){};T.__name__=!0,T.isSpace=function(t,e){var i=g.cca(t,e);return 8<i&&i<14||32==i},T.ltrim=function(t){for(var e=t.length,i=0;i<e&&T.isSpace(t,i);)++i;return 0<i?g.substr(t,i,e-i):t},T.rtrim=function(t){for(var e=t.length,i=0;i<e&&T.isSpace(t,e-i-1);)++i;return 0<i?g.substr(t,0,e-i):t},T.trim=function(t){return T.ltrim(T.rtrim(t))},T.lpad=function(t,e,i){if(e.length<=0)return t;var r="";for(i-=t.length;r.length<i;)r+=null==e?"null":""+e;return r+=null==t?"null":""+t},T.rpad=function(t,e,i){if(e.length<=0)return t;var r="";for(r+=null==t?"null":""+t;r.length<i;)r+=null==e?"null":""+e;return r},T.hex=function(t,e){for(var i="";i="0123456789ABCDEF".charAt(15&t)+i,0<(t>>>=4););if(null!=e)for(;i.length<e;)i="0"+i;return i};function h(){}h.__name__=!0,e(h.prototype,{writeByte:function(t){lt.writeSync(this.fd,String.fromCodePoint(t))},writeBytes:function(t,e,i){var r=t.b;return lt.writeSync(this.fd,pt.from(r.buffer,r.byteOffset,t.length),e,i)},writeString:function(t,e){lt.writeSync(this.fd,t)},flush:function(){lt.fsyncSync(this.fd)},close:function(){lt.closeSync(this.fd)}});function E(){}E.__name__=!0,e(E.prototype,{readByte:function(){var t=pt.alloc(1);try{lt.readSync(this.fd,t,0,1,null)}catch(t){Z.lastError=t;var e=Y.caught(t).unwrap();throw"EOF"==e.code?Y.thrown(new it):Y.thrown(rt.Custom(e))}return t[0]},readBytes:function(t,e,i){var r=t.b,n=pt.from(r.buffer,r.byteOffset,t.length);try{return lt.readSync(this.fd,n,e,i,null)}catch(t){Z.lastError=t;var s=Y.caught(t).unwrap();throw"EOF"==s.code?Y.thrown(new it):Y.thrown(rt.Custom(s))}},close:function(){lt.closeSync(this.fd)}});var k=function(t,e){this._killed=!1,this.async=!1,this.killForce=null,this.killExtra=null,this.onStatus=function(t,e){},this.FLAG_PROGRESS_DISABLE=!1,this.uid=++k.UID,this.info=t,this.quickRun=e,this.set_status(U.waiting),null!=this.info&&"-"==this.info.charAt(0)&&(this.FLAG_PROGRESS_DISABLE=!0,this.info=g.substr(this.info,1,null))};k.__name__=!0,k.prototype={set_PROGRESS:function(t){return this.PROGRESS=t,this.PROGRESS<0?this.PROGRESS=0:100<this.PROGRESS&&(this.PROGRESS=100),this.FLAG_PROGRESS_DISABLE||this.onStatus(U.progress,this),t},set_status:function(t){return this.status=t,this.onStatus(t,this),t},get_jobData:function(){return this.parent.jobData},set_jobData:function(t){return this.jobData=t},start:function(){var t=process.hrtime();this.timeStart=t[0]+t[1]/1e9,this.set_status(U.start),this.set_PROGRESS(0),null!=this.quickRun&&this.quickRun(this)},complete:function(){var t=this;this.status!=U.forcekill&&(this.set_PROGRESS(100),this.set_status(U.complete),null!=this.onComplete&&$.delay(function(){t.onComplete()},1))},fail:function(t,e){var i=this;this.status!=U.forcekill&&(this.ERROR=t,this.set_status(U.fail),null!=this.onFail&&$.delay(function(){i.onFail()},1))},kill:function(){this._killed||(this._killed=!0,this.status!=U.complete&&(this.set_status(U.forcekill),null!=this.killForce&&this.killForce()),null!=this.killExtra&&this.killExtra())},syncWith:function(t){var e=this;t.onComplete=gt(this,this.complete),t.onFail=function(t){e.fail(t,null)},t.onProgress=function(t){e.set_PROGRESS(t)}},toString:function(){return(null==this.info?"":"["+this.info+"]")+" uid_"+this.uid+" slot_"+this.SLOT+(this.async?" (async)":"")},__properties__:{set_jobData:"set_jobData",get_jobData:"get_jobData",set_status:"set_status",set_PROGRESS:"set_PROGRESS"}};var v=function(){k.call(this,"Cutting BIN into Track Files")};v.__name__=!0,v.__super__=k,v.prototype=e(k.prototype,{start:function(){var i=this;k.prototype.start.call(this);var r=this.parent,n=r.cd.tracks[0].workingFile;if(r.cd.MULTIFILE)return H.log("- No need to cut a multifile cd. Returning"),void this.complete();if(1==r.cd.tracks.length)return H.log("- No need to cut a CD with only 1 track. Returning"),void this.complete();r.flag_tracksOnTempFolder=!0;var s=Math.round(100/r.cd.tracks.length);H.log(" - Cutting tracks from `"+n+"` to `"+r.tempDir+"`");var o=new z(r.cd.tracks);o.queue_complete=gt(this,this.complete),o.queue_action=function(t){H.log(" - Cutting Track "+t.trackNo),t.workingFile=ut.join(r.tempDir,t.getFilenameRaw());var e=t.sectorStart*r.cd.SECTOR_SIZE;K.copyFilePart(n,t.workingFile,e,t.byteSize,function(t){i.set_PROGRESS(i.PROGRESS+s),null==t?o.next():i.fail(t,{fileName:"src/TaskCutTrackFiles.hx",lineNumber:64,className:"TaskCutTrackFiles",methodName:"start"})})},o.start(),this.killExtra=gt(o,o.kill)}});var w=function(t){k.call(this,"Encoding Track "+t.trackNo),this.track=t};w.__name__=!0,w.__super__=k,w.prototype=e(k.prototype,{setupTrackFiles:function(t){var e=this.track.getTrackName();this.track.storedFileName=e+t,this.j.p.flag_convert_only?this.track.workingFile=ut.join(this.j.p.outputDir,this.track.storedFileName):this.track.workingFile=ut.join(this.j.tempDir,this.track.storedFileName)},syncWith:function(t){var e=this;t.onComplete=function(){t.onComplete=null,!c.FLAG_KEEP_TEMP&&e.j.flag_tracksOnTempFolder&&lt.unlinkSync(e.sourceTrackFile),e.complete()},t.onFail=function(t){e.fail(t,null)},t.onProgress=function(t){e.set_PROGRESS(t)}},start:function(){if(k.prototype.start.call(this),this.j=this.parent,this.sourceTrackFile=this.track.workingFile,this.track.md5=K.getFileMD5(this.sourceTrackFile),null==this.track.md5&&this.fail("Could not calculate MD5 of "+this.sourceTrackFile,{fileName:"src/TaskEncodeTrack.hx",lineNumber:82,className:"TaskEncodeTrack",methodName:"start"}),this.track.isData){this.setupTrackFiles(".bin.ecm");var t=new x(c.TOOLS_PATH);return this.killExtra=gt(t,t.kill),this.syncWith(t),void t.ecm(this.sourceTrackFile,this.track.workingFile)}var e,i,r,n=new A(c.FFMPEG_PATH);this.setupTrackFiles(_.getAudioExt(this.j.AC.id)),"TAK"==this.j.AC.id?(e=new I(c.TOOLS_PATH),this.syncWith(e),this.killExtra=function(){e.kill(),n.kill()},i=e.streamEncode(this.track.workingFile),(r=n.stream_PCMtoWAVStream())._out.pipe(i),lt.createReadStream(this.sourceTrackFile).pipe(r._in)):(this.syncWith(n),this.killExtra=gt(n,n.kill),n.encodeFromPCM(this.sourceTrackFile,_.getAudioStr(this.j.AC),this.track.workingFile))}});var R=function(t){null==t&&(t=!0),k.call(this,"Joining tracks into a single .bin"),this.flag_delete_processed=t};R.__name__=!0,R.__super__=k,R.prototype=e(k.prototype,{start:function(){var e=this;if(k.prototype.start.call(this),this.j=this.parent,1==this.j.cd.tracks.length)return H.log("> No need to Join, already 1 track on the CD"),void this.complete();var i,r=this.j.cd.tracks[0].workingFile,n=Math.round(100/this.j.cd.tracks.length),s=new z(this.j.cd.tracks);this.killExtra=gt(s,s.kill),s.queue_complete=gt(this,this.complete),s.queue_action=function(t){1!=(i=t).trackNo?K.copyFilePart(t.workingFile,r,0,0,function(t){null!=t?e.fail(t,{fileName:"src/TaskJoinTrackFiles.hx",lineNumber:60,className:"TaskJoinTrackFiles",methodName:"start"}):(1<i.trackNo&&(H.log("Joined `Track "+i.trackNo+"` -> into -> `Track 1`"),e.flag_delete_processed&&!c.FLAG_KEEP_TEMP&&lt.unlinkSync(i.workingFile),i.workingFile=null),e.set_PROGRESS(e.PROGRESS+n),s.next())}):s.next()},s.start()}});var O=function(t){this.track=t,k.call(this,"Restoring Track "+t.trackNo)};O.__name__=!0,O.__super__=k,O.prototype=e(k.prototype,{start:function(){k.prototype.start.call(this),this.j=this.parent,this.crushedTrackPath=ut.join(this.j.tempDir,this.track.storedFileName);var t=this.j.tempDir,e=this.track.getFilenameRaw();this.track.workingFile=ut.join(t,e);var i=ut.extname(this.track.storedFileName).toLowerCase();if(this.isLosslessAudio=0<=[".flac",".tak"].indexOf(i),this.track.isData){var r=new x(c.TOOLS_PATH);return this.syncWith(r),this.killExtra=gt(r,r.kill),void r.unecm(this.crushedTrackPath,this.track.workingFile)}if(this.j.p.flag_encCue)return this.track.workingFile=this.crushedTrackPath,void this.complete();var n,s,o=new A(c.FFMPEG_PATH);this.killExtra=gt(o,o.kill),this.syncWith(o),".tak"!=i?o.encodeToPCM(this.crushedTrackPath,this.track.workingFile):(n=new I(c.TOOLS_PATH),s=o.stream_WAVtoPCMFile(this.track.workingFile),n.streamDecode(this.crushedTrackPath).pipe(s))},complete:function(){c.FLAG_KEEP_TEMP||lt.unlinkSync(this.crushedTrackPath);try{this.track.isData||this.isLosslessAudio||this.correctPCMSize(),this.checkRestoredMD5()}catch(t){Z.lastError=t;var e=Y.caught(t).unwrap();if("string"!=typeof e)throw t;return void this.fail(e,{fileName:"src/TaskRestoreTrack.hx",lineNumber:103,className:"TaskRestoreTrack",methodName:"complete"})}k.prototype.complete.call(this)},correctPCMSize:function(){H.log("+ Correcting PCM Size -- for track "+this.track.trackNo);var t=this.track.byteSize;lt.truncateSync(this.track.workingFile,t)},checkRestoredMD5:function(){}});function y(t){this.onProgress=function(t){},this.progress=-1,this.COMPRESSED_SIZE=0,this.app=new W(t)}y.__name__=!0,y.prototype={set_progress:function(t){return t==this.progress||(this.progress=t,this.onProgress(t)),t},compress:function(t,e,i){return!1},extract:function(t,e,i){return!1},append:function(t,e){return!1},kill:function(){null!=this.app&&this.app.kill()},__properties__:{set_progress:"set_progress"}};var x=function(t){this.expr_enc=new f("\\s*Encoding \\((\\d{1,3})%",""),this.expr_dec=new f("\\s*Decoding \\((\\d{1,3})%",""),this.exe_ecm=ut.join(t,"ecm.exe"),this.exe_unecm=ut.join(t,"unecm.exe")};x.__name__=!0,x.prototype={ecm:function(t,e){this.app=new W(this.exe_ecm),this.setup("encode"),null==e?this.app.start([t]):this.app.start([t,e])},unecm:function(t,e){this.app=new W(this.exe_unecm),this.setup("decode"),null==e?this.app.start([t]):this.app.start([t,e])},setup:function(t){var e,i=this;this.app.onClose=function(t){t?null!=i.onComplete&&i.onComplete():(i.ERROR=i.app.ERROR,null!=i.onFail&&i.onFail(i.ERROR))},e="encode"==t?this.expr_enc:this.expr_dec,this.app.onStdErr=function(t){e.match(t)&&null!=i.onProgress&&i.onProgress(S.parseInt(e.matched(1)))}},kill:function(){null!=this.app&&this.app.kill()}};var A=function(t){null==t&&(t="");var e=this;this.app=new W(A.WIN32_EXE,t),this.app.FLAG_ERRORS_ON_STDERR=!0,this.app.LOG_STDOUT=!1,this.targetSeconds=this.progress=this.secondsConverted=0,this.app.onStdErr=function(t){0!=e.targetSeconds&&(e.secondsConverted=e.parseSecondsFromData(t,"time=(\\d{2}):(\\d{2}):(\\d{2})"),-1!=e.secondsConverted&&(e.progress=Math.ceil(e.secondsConverted/e.targetSeconds*100),100<e.progress&&(e.progress=100),null!=e.onProgress&&e.onProgress(e.progress)))},this.app.onClose=function(t){t?null!=e.onComplete&&e.onComplete():(e.ERROR=e.app.ERROR,null!=e.onFail&&e.onFail(e.ERROR))}};A.__name__=!0,A.prototype={exists:function(){return this.app.exists("-version")},parseSecondsFromData:function(t,e){var i,r,n=new f(e,""),s=-1;return n.match(t)&&(i=S.parseInt(n.matched(1)),r=S.parseInt(n.matched(2)),s=S.parseInt(n.matched(3))+60*r+360*i),s},getSecondsFromFile:function(t,r){var n,s=this;W.quickExec(this.app.exePath+' -i "'+t+'"',function(t,e,i){n=s.parseSecondsFromData(i,"\\s*Duration:\\s*(\\d{2}):(\\d{2}):(\\d{2})"),r(n)})},encodeFromPCM:function(t,e,i){H.log('Encoding PCM "'+t+'" to "'+i+'"'),this.secondsConverted=this.progress=0,this.targetSeconds=Math.floor((0|lt.statSync(t).size)/176400),null!=this.onProgress&&this.onProgress(0);var r=["-y","-f","s16le","-ar","44100","-ac","2","-i",t].concat(e.split(" "));r.push(i),this.app.start(r)},encodeToPCM:function(e,i){var r=this;null==i&&null==i&&(i=K.getPathNoExt(e)+".pcm"),this.secondsConverted=this.progress=0,null!=this.onProgress&&this.onProgress(0),this.getSecondsFromFile(e,function(t){return t<0?(r.ERROR='Could not read "'+e+'"',void(null!=r.onFail&&r.onFail(r.ERROR))):(r.targetSeconds=t,H.log('Converting "'+e+'" to PCM "'+i+'"'),void r.app.start(["-i",e,"-y","-f","s16le","-acodec","pcm_s16le",i]))})},stream_WAVtoPCMFile:function(t){return H.log('Converting WAV STREAM to PCM "'+t+'"'),this.targetSeconds=0,this.app.start(["-f","wav","-i","pipe:0","-y","-f","s16le","-acodec","pcm_s16le",t]),this.app.proc.stdin},stream_PCMtoEncFile:function(t,e){H.log('Encoding Stream to --\x3e "'+e+'"'),this.targetSeconds=0;var i=["-y","-f","s16le","-ar","44100","-ac","2","-i","pipe:0"].concat(t.split(" "));return i.push(e),this.app.start(i),this.app.proc.stdin},stream_PCMtoWAVStream:function(){return H.log("Converting PCM Stream to WAV Stream"),this.targetSeconds=0,this.app.start(["-f","s16le","-ar","44100","-ac","2","-i","pipe:0","-f","wav","-"]),{_in:this.app.proc.stdin,_out:this.app.proc.stdout}},kill:function(){null!=this.app&&this.app.kill()}};var F=function(t){null==t&&(t="");var r=this;y.call(this,ut.join(t,F.WIN32_EXE)),this.app.onClose=function(t){if(!t)return r.ERROR=r.app.ERROR,void(null!=r.onFail&&r.onFail(r.ERROR));var e,i;"compress"!=r.operation||(e=new f("=> (.*) bytes","")).match(r.app.stdOutLog)&&(i=e.matched(1).split(",").join(""),r.COMPRESSED_SIZE=parseFloat(i),H.log(r.ARCHIVE_PATH+" Compressed size = "+r.COMPRESSED_SIZE)),null!=r.onComplete&&r.onComplete()};var e=new f("(\\d{1,3})%\\s*$","");this.app.onStdOut=function(t){e.match(t)&&r.set_progress(S.parseInt(e.matched(1)))}};F.__name__=!0,F.getCompressionString=function(t){return null==t&&(t=4),t<1?t=1:9<t&&(t=9),"-m"+t},F.__super__=y,F.prototype=e(y.prototype,{compress:function(t,e,i){this.ARCHIVE_PATH=e,H.log('Compressing "'+S.string(t)+'" to "'+e+'" ... Compression:'+i),this.operation="compress",this.set_progress(0);var r=["create","-mt0","-i1","-ep"];return null!=i&&(r=r.concat(i.split(" "))),r.push(e),r=r.concat(t),this.app.start(r),!0},extract:function(t,e,i){this.ARCHIVE_PATH=t,this.operation="extract",this.set_progress(0);var r=["e","-o+","-i1","-mt0","-dp"+e,t],n="";return null==i?n="all files":(n=i.join(","),r=r.concat(i)),H.log("Extracting ["+n+'] from "'+t+'" to "'+e+'"'),this.app.start(r),!0},append:function(t,e){if(this.ARCHIVE_PATH=t,!lt.existsSync(t))return this.ERROR="Archive does not exist "+t,!1;this.operation="append",this.set_progress(0),H.log("Appending [ "+e.join(",")+'] into "'+t+'"');var i=["a","--append","-mt0","-i1","-ep",t].concat(e);return this.app.start(i),!0}});var C=function(t){null==t&&(t="");var r=this;y.call(this,ut.join(t,C.WIN32_EXE)),this.app.LOG_STDOUT=!0,this.app.LOG_STDERR=!0,this.app.onClose=function(t){if(!t)return r.ERROR=r.app.ERROR,void(null!=r.onFail&&r.onFail(r.ERROR));var e,i;"compress"!=r.operation||(e=new f("Archive size: (\\d+)","")).match(r.app.stdOutLog)&&(i=parseFloat(e.matched(1)),r.COMPRESSED_SIZE=i,H.log(r.ARCHIVE_PATH+" Compressed size = "+r.COMPRESSED_SIZE)),null!=r.onComplete&&r.onComplete()};var e=new f("(\\d+)%","");this.app.onStdOut=function(t){e.match(t)&&r.set_progress(S.parseInt(e.matched(1)))}};C.__name__=!0,C.getCompressionString=function(t){return null==t&&(t=4),t<1?t=1:9<t&&(t=9),"-mx"+t},C.__super__=y,C.prototype=e(y.prototype,{compress:function(t,e,i){this.ARCHIVE_PATH=e,this.operation="compress",this.set_progress(0),H.log('Compressing "'+S.string(t)+'" to "'+e+'" ... Compression:'+i),i==C.S01?(i=null,this.operation="update"):lt.existsSync(e)&&lt.unlinkSync(e);var r=["a","-bsp1","-mmt"];return null!=i&&(r=r.concat(i.split(" "))),r.push(e),r=r.concat(t),this.app.start(r),!0},extract:function(t,e,i){this.ARCHIVE_PATH=t,this.operation="extract",this.set_progress(0);var r=["e",t,"-bsp1","-mmt","-aoa","-o"+e],n="";return null==i?n="all files":(n=i.join(","),r=r.concat(i)),H.log("Extracting ["+n+'] from "'+t+'" to "'+e+'"'),this.app.start(r),!0},append:function(t,e){return this.compress(e,t,C.S01),!0}});var I=function(t){var e=this;this.app=new W(I.WIN32_EXE,t),this.app.LOG_STDOUT=!1,this.app.onClose=function(t){t?null!=e.onComplete&&e.onComplete():(e.ERROR=e.app.ERROR,null!=e.onFail&&e.onFail(e.ERROR))}};I.__name__=!0,I.prototype={streamEncode:function(t){return H.log('Encoding WAV Stream to TAK "'+t+'"'),this.app.start(["-e","-ihs","-",t]),this.app.proc.stdin},streamDecode:function(t){return H.log("Converting TAK File to WAV Stream"),this.app.start(["-d",t,"-"]),this.app.proc.stdout},kill:function(){null!=this.app&&this.app.kill()}};var L=function(){this.CD_TITLE="untitled",this.CD_TYPE=null,this.CD_AUDIO_QUALITY=null,this.CD_TOTAL_SIZE=0,this.SECTOR_SIZE=0,this.MULTIFILE=!1,this.tracks=[],this.openTrack=null,this.openFile=null};L.__name__=!0,L.LOG=function(t){},L.getSectorsByDataType=function(t){switch(t){case"AUDIO":case"CDG":return 2352;case"CDI/2336":return 2336;case"CDI/2352":return 2352;case"MODE1/2048":return 2048;case"MODE1/2352":return 2352;case"MODE2/2336":return 2336;case"MODE2/2352":return 2352;default:throw Y.thrown("Unsuported type "+t)}},L.prototype={cueLoad:function(t){if(L.LOG("cueLoad(): Loading `"+t+"`"),!_t.exists(t))throw Y.thrown("File "+t+" does not exist.");var e=nt.directory(t);if("cue"!=nt.extension(t).toLowerCase())throw Y.thrown("File "+t+" must be a `.CUE` file.");var i=lt.readFileSync(t,{encoding:"utf8"}).split("\n"),r=new f("([^/\\\\]*)\\.cue$","i");r.match(t)&&(this.CD_TITLE=r.matched(1)),L.LOG("Guessed cd title = "+this.CD_TITLE);for(var n=0,s=i.length;n<s;){var o=n++,a=i[o];if(0!=a.length){a=T.trim(a);try{this.cue_parser(a)}catch(t){Z.lastError=t;var l=Y.caught(t).unwrap();if("string"!=typeof l)throw t;throw Y.thrown("Cue Parse Error ( Line "+o+" ) : "+l)}}}if(this.openTrack=null,0==this.tracks.length)throw Y.thrown("No tracks in the .Cue file");for(n=0,s=this.tracks;n<s.length;){var c=s[n];if(++n,c.isData){this.CD_TYPE=c.trackType;break}}null==this.CD_TYPE&&(this.CD_TYPE="AUDIO"),this.SECTOR_SIZE=L.getSectorsByDataType(this.CD_TYPE);for(var u=0,n=0,s=this.tracks;n<s.length;){c=s[n];if(++n,0==c.indexes.length)throw Y.thrown("Track "+c.trackNo+" has no indexes defined");if(null!=c.trackFile){if(++u,c.workingFile=nt.join([e,c.trackFile]),!_t.exists(c.workingFile))throw Y.thrown("TrackFile "+c.trackFile+" is defined but does not exist");var h=lt.statSync(c.workingFile);if(c.byteSize=h.size,c.sectorSize=Math.ceil(c.byteSize/this.SECTOR_SIZE),c.sectorSize<=0)throw Y.thrown("TrackFile "+c.trackFile+" is corrupted.");this.CD_TOTAL_SIZE+=c.byteSize}}if(u==this.tracks.length&&1<u)L.LOG("Multi-File CD Image"),this.MULTIFILE=!0,this.initTracks_SectorStart();else{if(1!=u)throw 0==u?Y.thrown("There are no image files defined in the cuesheet"):Y.thrown("Not Supported. Either one track file or all track files");L.LOG("Single-File CD image"),this.MULTIFILE=!1;var p=this.tracks[0].sectorSize,_=this.tracks.length-1;for(this.tracks[_].initSectorStartFromIndex(),this.tracks[_].sectorSize=p-this.tracks[_].sectorStart;0<=--_;)this.tracks[_].initSectorStartFromIndex(),this.tracks[_].sectorSize=this.tracks[_+1].sectorStart-this.tracks[_].sectorStart;this.initTracks_byteSize()}},cueSave:function(t,e){L.LOG("Saving .cue, "+t);if(0==this.tracks.length)throw Y.thrown("There is no data to save");for(var i,r,n="",s=0;;){if(null!=(i=this.tracks[s]).trackFile){switch(nt.extension(i.trackFile).toLowerCase()){case"flac":r="WAVE";break;case"mp3":r="MP3";break;case"ogg":r="OGG";break;case"tak":r="WAVE";break;default:r="BINARY"}n+='FILE "'+i.trackFile+'" '+r+"\n"}n+="  TRACK "+T.lpad(""+i.trackNo,"0",2)+" "+i.trackType+"\n",null!=i.pregap&&(n+="    PREGAP "+i.pregap.toString()+"\n");for(var o=0,a=i.indexes.length;o<a;){var l=o++;n+="    INDEX "+T.lpad(""+i.indexes[l].no,"0",2)+" "+i.indexes[l].toString()+"\n"}if(!(++s<this.tracks.length))break}if(n+="REM ------------------------------\n",null!=this.CD_AUDIO_QUALITY&&(n+="REM Audio Quality : "+this.CD_AUDIO_QUALITY+"\n"),null!=e)for(o=0;o<e.length;){var c=e[o];++o,n+="REM "+c+"\n"}lt.writeFileSync(t,n)},jsonLoad:function(t){if(L.LOG("jsonLoad(): Loading `"+t+"`"),!_t.exists(t))throw Y.thrown("File "+t+" does not exist.");var e=JSON.parse(lt.readFileSync(t,{encoding:"utf8"}));if(null==e)throw Y.thrown("Can't parse parameters file");var i=1;Object.prototype.hasOwnProperty.call(e,"version")&&(i=e.version);var r=e.tracks;if(1==i){var n=e.sectorSize;1==r.length&&(r[0].sectorSize=Math.ceil(e.imageSize/n));for(var s=0;s<r.length;){var o=r[s];++s,o.diskFileSize=o.sectorSize*n}++i}if(2==i){for(var a=0,l="",c=null,s=0;s<r.length;){o=r[s];++s,o.trackType=o.type,o.indexes=o.indexAr,o.storedFileName=o.filename,o.byteSize=o.diskFileSize,o.md5="-",null==c&&"AUDIO"!=o.trackType&&(c=o.trackType),null!=o.diskFile&&++a,null==l&&"AUDIO"==o.trackType&&(l=nt.extension(o.filename))}null!=l?("ogg"==l&&(e.audio="Ogg Vorbis ??? k Vbr"),"flac"==l&&(e.audio="FLAC Lossless")):e.audio=null,e.totalSize=e.imageSize,e.multiFile=1<a&&a==r.length,e.cdType=null==c?"AUDIO":c,++i}if(3==i)for(s=0;s<r.length;){o=r[s];++s,(0<o.pregapMinutes||0<o.pregapSeconds||0<o.pregapMillisecs)&&(o.pregap=new b(0,o.pregapMinutes,o.pregapSeconds,o.pregapMillisecs));for(var u=o.indexes,h=0;h<u.length;){var p=u[h];++h,p.frames=p.millisecs,m.deleteField(p,"millisecs")}}this.tracks=[];for(s=0;s<r.length;){o=r[s];++s;var _=new D;_.fromJSON(o),this.tracks.push(_)}this.CD_TITLE=e.cdTitle,this.CD_TYPE=e.cdType,this.CD_TOTAL_SIZE=e.totalSize,this.CD_AUDIO_QUALITY=e.audio,this.MULTIFILE=e.multiFile,this.SECTOR_SIZE=e.sectorSize,0==this.tracks[0].byteSize&&this.initTracks_byteSize(),1<this.tracks.length&&0==this.tracks[1].sectorStart&&this.initTracks_SectorStart()},jsonSave:function(t){if(0==this.tracks.length)throw Y.thrown("Warning , No tracks to save");for(var e=0,i=this.tracks;e<i.length;){var r=i[e];if(++e,null==r.storedFileName)throw Y.thrown("Track "+r.trackNo+" should have a filename set.")}for(var n=L.VERSION,s=this.CD_TITLE,o=this.CD_TYPE,a=this.CD_AUDIO_QUALITY,l=this.SECTOR_SIZE,c=this.CD_TOTAL_SIZE,u=this.MULTIFILE,e=[],i=0,h=this.tracks;i<h.length;){var p=h[i];++i,e.push(p.toJSON())}var _={version:n,cdTitle:s,cdType:o,audio:a,sectorSize:l,totalSize:c,multiFile:u,tracks:e};lt.writeFileSync(t,JSON.stringify(_,null,"\t"))},initTracks_SectorStart:function(){if(0!=this.tracks.length)for(var t=0,e=0,i=this.tracks.length;e<i;){var r=e++;this.tracks[r].sectorStart=t,t+=this.tracks[r].sectorSize}},initTracks_byteSize:function(){if(0!=this.tracks.length)for(var t=0,e=this.tracks;t<e.length;){var i=e[t];++t,i.byteSize=i.sectorSize*this.SECTOR_SIZE}},cue_parser:function(t){if(new f("^FILE","i").match(t)){this.openTrack=null;var e=new f('"+',"g").split(t);if(e.length<3)throw Y.thrown("Could not read Track File");var i=T.trim(e.pop()).toUpperCase();if(L.SUPPORTED_TRACK_FILES.indexOf(i)<0)throw Y.thrown("Unsupported Track File Type "+i);return e.shift(),void(this.openFile=e.join(""))}var r=new f("^\\s*TRACK\\s+(\\d+)\\s+(\\S+)","i");if(r.match(t)){this.openTrack=null;for(var n=0,s=this.tracks;n<s.length;){var o=s[n];if(++n,o.trackNo==S.parseInt(r.matched(1)))throw Y.thrown("Track "+o.trackNo+" is already defined")}var a=new D;return a.set(S.parseInt(r.matched(1)),r.matched(2)),a.trackFile=this.openFile,this.openFile=null,this.openTrack=a,void this.tracks.push(a)}var l=new f("^\\s*INDEX\\s+(\\d+)\\s+(\\d{1,2}):(\\d{1,2}):(\\d{1,2})","i");if(l.match(t)){if(null==this.openTrack)throw Y.thrown("A Track is not defined yet");var c=S.parseInt(l.matched(1));if(this.openTrack.indexExists(c))throw Y.thrown("Track {"+S.string(this.openTrack)+".trackNo} , Duplicate Index entry. Index("+c+")");this.openTrack.addIndex(c,S.parseInt(l.matched(2)),S.parseInt(l.matched(3)),S.parseInt(l.matched(4)))}else{var u=new f("^\\s*PREGAP\\s+(\\d{1,2}):(\\d{1,2}):(\\d{1,2})","i");if(u.match(t)){if(null==this.openTrack)throw Y.thrown("A Track is not defined yet");this.openTrack.setPregap(S.parseInt(u.matched(1)),S.parseInt(u.matched(2)),S.parseInt(u.matched(3)))}else if(new f("^TITLE","i").match(t)){if(null!=this.openTrack)return;var h=new f('.+"(.+)"$',"i");if(!h.match(t))throw Y.thrown("TITLE error");this.CD_TITLE=h.matched(1)}}},getDetailedInfo:function(){for(var t="Title\t:  "+this.CD_TITLE+" "+L.NEWLINE+"Type\t:  "+this.CD_TYPE+" "+L.NEWLINE+"Audio\t:  "+this.CD_AUDIO_QUALITY+" "+L.NEWLINE+"Tracks\t:  "+this.tracks.length+" "+L.NEWLINE+"-------------------------------------------------- "+L.NEWLINE+" #  Type       Pregap   Sectors  Size      MD5 "+L.NEWLINE,e="",i=0,r=0,n=this.tracks;r<n.length;){var s=n[r];++r,i+=s.sectorSize,e+=" "+T.rpad(""+s.trackNo," ",3)+T.rpad(s.trackType," ",11)+(null!=s.pregap?T.rpad(s.pregap.toString()," ",9):"00:00:00 ")+T.rpad(""+s.sectorSize," ",9)+T.rpad(""+s.byteSize," ",10)+s.md5+L.NEWLINE}return t+(e+="-------------------------------------------------- "+L.NEWLINE+"Total Sectors : "+i+" "+L.NEWLINE+"Total Size    : "+this.CD_TOTAL_SIZE+" "+L.NEWLINE)},LOGINFOS:function(){}};var D=function(){this.indexes=[],this.pregap=null,this.trackNo=0,this.set_trackType(null),this.sectorStart=0,this.sectorSize=0,this.byteSize=0,this.md5="-",this.storedFileName=null,this.isData=!1,this.workingFile=null,this.trackFile=null};D.__name__=!0,D.prototype={set:function(t,e){this.trackNo=t,this.set_trackType(e),L.getSectorsByDataType(this.trackType)},set_trackType:function(t){return this.trackType=t,null!=this.trackType&&(this.isData="AUDIO"!=this.trackType),this.trackType},initSectorStartFromIndex:function(){this.sectorStart=this.indexes[0].toFrames()},addIndex:function(t,e,i,r){this.indexes.push(new b(t,e,i,r))},indexExists:function(t){for(var e=0,i=this.indexes;e<i.length;){var r=i[e];if(++e,r.no==t)return!0}return!1},setPregap:function(t,e,i){this.pregap=new b(0,t,e,i)},rewriteIndexes_forMultiFile:function(){if(0!=this.indexes.length){var t=this.indexes[0].toFrames();this.indexes[0].fromFrames(0);for(var e=1,i=this.indexes.length;e<i;){var r=e++,n=this.indexes[r].toFrames()-t;this.indexes[r].fromFrames(n)}}},rewriteIndexes_forSingleFile:function(){var t=this.indexes.slice();this.indexes=[],this.indexes.push((new b).fromFrames(this.sectorStart));for(var e=1,i=t.length;e<i;){var r=e++;this.indexes.push(new b(r).fromFrames(this.sectorStart+t[r].toFrames()))}},getTrackName:function(){return"track"+T.lpad(""+this.trackNo,"0",2)},getFilenameRaw:function(){return this.getTrackName()+(this.isData?".bin":".pcm")},toString_:function(){for(var t="",e=0,i=this.indexes;e<i.length;){var r=i[e];++e,t+=S.string(r)+", "}return"Track #"+this.trackNo+", type:"+this.trackType+", indexes:["+t+"], size:"+this.byteSize+", sectorStart:"+this.sectorStart+", sectorSize:"+this.sectorSize+", CueFile:"+this.trackFile+", storedFile:"+this.storedFileName+", md5:"+this.md5},toJSON:function(){return{trackNo:this.trackNo,trackType:this.trackType,sectorStart:this.sectorStart,sectorSize:this.sectorSize,byteSize:this.byteSize,storedFileName:this.storedFileName,md5:this.md5,pregap:this.pregap,indexes:this.indexes}},fromJSON:function(t){for(var e=0,i=m.fields(t);e<i.length;){var r=i[e];++e,"pregap"!=r&&Object.prototype.hasOwnProperty.call(this,r)&&m.setProperty(this,r,m.field(t,r))}null!=t.pregap&&(this.pregap=new b,this.pregap.fromJSON(t.pregap)),this.indexes=[];for(var n=t.indexes,e=0;e<n.length;){var s=n[e];++e;var o=new b;o.fromJSON(s),this.indexes.push(o)}},__properties__:{set_trackType:"set_trackType"}};var b=function(t,e,i,r){null==r&&(r=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.no=t,this.minutes=e,this.seconds=i,this.frames=r};b.__name__=!0,b.prototype={toFrames:function(){return 75*this.seconds+60*this.minutes*75+this.frames},fromFrames:function(t){return this.minutes=Math.floor(t/4500),this.seconds=Math.floor(t%4500/75),this.frames=t%75,this},toString:function(){return T.lpad(""+this.minutes,"0",2)+":"+T.lpad(""+this.seconds,"0",2)+":"+T.lpad(""+this.frames,"0",2)},fromJSON:function(t){for(var e=0,i=m.fields(t);e<i.length;){var r=i[e];++e,this[r]=m.field(t,r)}}};function N(){}var P=d["djNode.KeycodeID"]={__ename__:!0,__constructs__:["up","down","left","right","home","insert","delete","end","pageup","pagedown","backsp","tab","enter","space","esc","ctrlC","acute","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","other"],up:{_hx_index:0,__enum__:"djNode.KeycodeID",toString:n},down:{_hx_index:1,__enum__:"djNode.KeycodeID",toString:n},left:{_hx_index:2,__enum__:"djNode.KeycodeID",toString:n},right:{_hx_index:3,__enum__:"djNode.KeycodeID",toString:n},home:{_hx_index:4,__enum__:"djNode.KeycodeID",toString:n},insert:{_hx_index:5,__enum__:"djNode.KeycodeID",toString:n},delete:{_hx_index:6,__enum__:"djNode.KeycodeID",toString:n},end:{_hx_index:7,__enum__:"djNode.KeycodeID",toString:n},pageup:{_hx_index:8,__enum__:"djNode.KeycodeID",toString:n},pagedown:{_hx_index:9,__enum__:"djNode.KeycodeID",toString:n},backsp:{_hx_index:10,__enum__:"djNode.KeycodeID",toString:n},tab:{_hx_index:11,__enum__:"djNode.KeycodeID",toString:n},enter:{_hx_index:12,__enum__:"djNode.KeycodeID",toString:n},space:{_hx_index:13,__enum__:"djNode.KeycodeID",toString:n},esc:{_hx_index:14,__enum__:"djNode.KeycodeID",toString:n},ctrlC:{_hx_index:15,__enum__:"djNode.KeycodeID",toString:n},acute:{_hx_index:16,__enum__:"djNode.KeycodeID",toString:n},F1:{_hx_index:17,__enum__:"djNode.KeycodeID",toString:n},F2:{_hx_index:18,__enum__:"djNode.KeycodeID",toString:n},F3:{_hx_index:19,__enum__:"djNode.KeycodeID",toString:n},F4:{_hx_index:20,__enum__:"djNode.KeycodeID",toString:n},F5:{_hx_index:21,__enum__:"djNode.KeycodeID",toString:n},F6:{_hx_index:22,__enum__:"djNode.KeycodeID",toString:n},F7:{_hx_index:23,__enum__:"djNode.KeycodeID",toString:n},F8:{_hx_index:24,__enum__:"djNode.KeycodeID",toString:n},F9:{_hx_index:25,__enum__:"djNode.KeycodeID",toString:n},F10:{_hx_index:26,__enum__:"djNode.KeycodeID",toString:n},F11:{_hx_index:27,__enum__:"djNode.KeycodeID",toString:n},F12:{_hx_index:28,__enum__:"djNode.KeycodeID",toString:n},other:{_hx_index:29,__enum__:"djNode.KeycodeID",toString:n}};N.__name__=!0,N.toKeyCodeID=function(t){if(null==g.cca(t,1))switch(g.cca(t,0)){case 3:return P.ctrlC;case 8:return P.backsp;case 9:return P.tab;case 13:return P.enter;case 27:return P.esc;case 32:return P.space;case 96:return P.acute;case 127:return P.backsp}else if(27==g.cca(t,0)&&91==g.cca(t,1))switch(g.cca(t,2)){case 49:switch(g.cca(t,3)){case 55:return P.F6;case 56:return P.F7;case 57:return P.F8;case 126:return P.home}break;case 50:switch(g.cca(t,3)){case 48:return P.F9;case 49:return P.F10;case 51:return P.F11;case 52:return P.F12;case 126:return P.insert}break;case 51:return P.delete;case 52:return P.end;case 53:return P.pageup;case 54:return P.pagedown;case 65:return P.up;case 66:return P.down;case 67:return P.right;case 68:return P.left;case 91:switch(g.cca(t,3)){case 65:return P.F1;case 66:return P.F2;case 67:return P.F3;case 68:return P.F4;case 69:return P.F5}}return null};var M=function(){};M.__name__=!0,M.startCapture=function(t,e){null==t&&(t=!0),M.stop(),null!=e&&(M.onData=e),M.stdin=process.stdin,M.stdin.setRawMode(t),M.stdin.setEncoding("utf8"),M.stdin.on("data",M.onKeyData),M.stdin.resume()},M.onKeyData=function(t){if(M.FLAG_CAN_BREAK&&t==N.CTRLC)return M.stop(),null!=M.onBreak&&M.onBreak(),void(M.onBreak=null);null!=M.onData&&M.onData(t)},M.stop=function(){null!=M.stdin&&(M.stdin.pause(),M.stdin.setRawMode(!1),M.stdin.removeAllListeners("data"))},M.flush=function(){null!=M.stdin&&(M.stdin.pause(),M.stdin.resume())},M.readOnceSync=function(){var t=pt.alloc(512),e=0,e=0;try{e=lt.readSync(process.stdin.fd,t,0,512,null)}catch(t){Z.lastError=t;var i=Y.caught(t).unwrap();throw console.log("djNode/Keyboard.hx:233:",i),Y.thrown(i)}return t.toString("utf8",0,e-2)};var j=function(){var t=new et;t.h.darkgray="[90m",t.h.red="[91m",t.h.green="[92m",t.h.yellow="[93m",t.h.blue="[94m",t.h.magenta="[95m",t.h.cyan="[96m",t.h.white="[97m",t.h.black="[30m",t.h.darkred="[31m",t.h.darkgreen="[32m",t.h.darkyellow="[33m",t.h.darkblue="[34m",t.h.darkmagenta="[35m",t.h.darkcyan="[36m",t.h.gray="[37m",this.COLORS_FG=t,(t=new et).h.darkgray="[100m",t.h.red="[101m",t.h.green="[102m",t.h.yellow="[103m",t.h.blue="[104m",t.h.magenta="[105m",t.h.cyan="[106m",t.h.white="[107m",t.h.black="[40m",t.h.darkred="[41m",t.h.darkgreen="[42m",t.h.darkyellow="[43m",t.h.darkblue="[44m",t.h.darkmagenta="[45m",t.h.darkcyan="[46m",t.h.gray="[47m",this.COLORS_BG=t};j.__name__=!0,j.prototype={getHeight:function(){return process.stdout.rows},fg:function(t){if(null==t)return process.stdout.write("[39m"),this;var e=this.COLORS_FG.h[t];return process.stdout.write(e),this},move:function(t,e){return process.stdout.cursorTo(t-1,e-1),this},moveR:function(t,e){return process.stdout.moveCursor(t,e),this},pageDown:function(t){null==t&&(t=0),0==t&&(t=this.getHeight());var e=T.lpad("","\n",t);return process.stdout.write(e),this.moveR(0,-t)},clearLine:function(t){return null==t&&(t=2),process.stdout.write("["+t+"K"),this},clearScreen:function(t){return null==t&&(t=2),0<t&&this.move(1,1),process.stdout.clearScreenDown(),this},drawLine:function(t,e){null==t&&(t=j.DEFAULT_LINE_SYMBOL),null==e&&(e=j.DEFAULT_LINE_WIDTH);var i=T.lpad("",t,e);return process.stdout.write(i),process.stdout.write("\n"),this},cursorHide:function(){return process.stdout.write("[?25l"),this},cursorShow:function(){return process.stdout.write("[?25h"),this},sprintf:function(t){var i=this;return new f("~(\\S[^~]*)~","g").map(t,function(t){var e=t.matched(1);switch(e){case"!":return"[0m";case"!.":return"[39m";case"!:":return"[49m";case"!b":return"[21m";case"b":return"[1m";case"line":return T.lpad("",j.DEFAULT_LINE_SYMBOL,j.DEFAULT_LINE_WIDTH)+"\n";case"line2":return T.lpad("",j.DEFAULT_LINE_SYMBOL,Math.ceil(j.DEFAULT_LINE_WIDTH/2))+"\n";default:try{return":"==e.charAt(0)?i.COLORS_BG.h[g.substr(e,1,null)]:i.COLORS_FG.h[e]}catch(t){return Z.lastError=t,""}}})}};var G=d["djNode.task.CJobStatus"]={__ename__:!0,__constructs__:["waiting","complete","allcomplete","init","start","fail","progress","taskStart","taskEnd"],waiting:{_hx_index:0,__enum__:"djNode.task.CJobStatus",toString:n},complete:{_hx_index:1,__enum__:"djNode.task.CJobStatus",toString:n},allcomplete:{_hx_index:2,__enum__:"djNode.task.CJobStatus",toString:n},init:{_hx_index:3,__enum__:"djNode.task.CJobStatus",toString:n},start:{_hx_index:4,__enum__:"djNode.task.CJobStatus",toString:n},fail:{_hx_index:5,__enum__:"djNode.task.CJobStatus",toString:n},progress:{_hx_index:6,__enum__:"djNode.task.CJobStatus",toString:n},taskStart:{_hx_index:7,__enum__:"djNode.task.CJobStatus",toString:n},taskEnd:{_hx_index:8,__enum__:"djNode.task.CJobStatus",toString:n}},U=d["djNode.task.CTaskStatus"]={__ename__:!0,__constructs__:["waiting","complete","start","fail","progress","forcekill"],waiting:{_hx_index:0,__enum__:"djNode.task.CTaskStatus",toString:n},complete:{_hx_index:1,__enum__:"djNode.task.CTaskStatus",toString:n},start:{_hx_index:2,__enum__:"djNode.task.CTaskStatus",toString:n},fail:{_hx_index:3,__enum__:"djNode.task.CTaskStatus",toString:n},progress:{_hx_index:4,__enum__:"djNode.task.CTaskStatus",toString:n},forcekill:{_hx_index:5,__enum__:"djNode.task.CTaskStatus",toString:n}},z=function(t){this.queue=null!=t?t:[]};z.__name__=!0,z.prototype={push:function(t){this.queue.push(t)},start:function(t,e){0!=this.queue.length&&(this.counter=-1,null!=t&&(this.queue_action=t),null!=e&&(this.queue_complete=e),this.next())},next:function(){null!=this.queue&&(++this.counter<this.queue.length?this.queue_action(this.queue[this.counter]):null==this.queue_complete||this.queue_complete())},kill:function(){this.queue=null}};var K=function(){};K.__name__=!0,K.createRecursiveDir=function(e){var i=ut.normalize(e).split(ut.sep),t=i.length;if(t<=0)throw Y.thrown('Path "'+e+'" is invalid');var r=0,n="";if(0<i[0].indexOf(":")){try{lt.statSync(i[0])}catch(t){throw Z.lastError=t,Y.caught(t).unwrap()instanceof Error?Y.thrown('Drive "'+i[0]+'" does not exist!'):t}r=1,n=i[0]+ut.sep}try{for(;r<t;)n=ut.join(n,i[r]),0==K.pathExists(n)&&lt.mkdirSync(n),++r}catch(t){throw Z.lastError=t,Y.caught(t).unwrap()instanceof Error?Y.thrown('Cannot create "'+e+'"'):t}},K.deleteRecursiveDir=function(t){if(K.pathExists(t)){for(var e=lt.readdirSync(t),i=0;i<e.length;){var r=e[i];++i;var n=ut.join(t,r);lt.lstatSync(n).isDirectory()?K.deleteRecursiveDir(n):lt.unlinkSync(n)}lt.rmdirSync(t)}},K.hasWriteAccess=function(t){try{lt.accessSync(t,2)}catch(t){if(Z.lastError=t,Y.caught(t).unwrap()instanceof Error)return!1;throw t}return!0},K.pathExists=function(t){try{lt.statSync(t)}catch(t){if(Z.lastError=t,Y.caught(t).unwrap()instanceof Error)return!1;throw t}return!0},K.moveFile=function(e,i){try{lt.renameSync(e,i)}catch(t){if(Z.lastError=t,!(Y.caught(t).unwrap()instanceof Error))throw t;K.copyFileSync(e,i);try{lt.unlinkSync(e)}catch(t){if(!(Y.caught(t).unwrap()instanceof Error))throw t;H.log('Could not delete "'+e+'" while moving.',3)}}},K.copyFileSync=function(t,e){lt.writeFileSync(e,lt.readFileSync(t))},K.copyFilePart=function(s,e,o,a,l){var c;null==a&&(a=0),null==o&&(o=0);var t=0;try{t=0|lt.statSync(s).size}catch(t){Z.lastError=t;var i=Y.caught(t).unwrap();if(i instanceof Error)return void l(i.message);throw t}if(0==a)a=t-o;else if(t<a+o)return void l("Trying to copy more bytes than the input file has.");H.log("Copying `"+s+"` Bytes ["+o+" [len]-> "+a+"] to `"+e+"`"),(c=lt.createWriteStream(e,{flags:"a"})).once("error",function(t){l("Cannot create/write to `"+e+"`")}),lt.open(s,"r",function(t,e){if(null==t){for(var i,r=0,n=a;0<n;)i=65536<=n?pt.allocUnsafe(65536):pt.allocUnsafe(n),r+=lt.readSync(e,i,0,i.byteLength,o+r),n-=i.byteLength,c.write(i);lt.closeSync(e),c.end(),c.once("close",function(){l(null)})}else l("Could not open file `"+s+"`")})},K.getFileListFromWildcard=function(t){var e,i=[],r=ut.dirname(t),n=K.getFileExt(t),s=new f("(\\S*)\\.","");if(s.match(ut.basename(t))){if(1<(e=s.matched(1)).length&&0<e.indexOf("*"))throw Y.thrown("Advanced search is currently unsupported, use basic [*.*] or [*.ext]")}else e="*";for(var o,a=lt.readdirSync(ut.normalize(r)),l=0;l<a.length;){var c=a[l];++l;try{o=lt.statSync(ut.join(r,c))}catch(t){Z.lastError=t;continue}if(o.isFile()){if("*"!=e){if(!s.match(c))continue;if(e!=s.matched(1))continue}if(".*"==n){i.push(ut.join(r,c));continue}if(n==ut.extname(c).toLowerCase()){i.push(ut.join(r,c));continue}}}return i},K.getFileMD5=function(t){var e=lt.openSync(t,"r"),i=at.createHash("md5"),r=pt.alloc(8192);try{for(var n;n=lt.readSync(e,r,0,8192,null),i.update(r.slice(0,n)),8192==n;);}catch(t){if(Z.lastError=t,Y.caught(t).unwrap()instanceof Error)return lt.closeSync(e),null;throw t}return lt.closeSync(e),i.digest("hex")},K.getFileExt=function(t){return ut.extname(t).toLowerCase()},K.getPathNoExt=function(t){return ut.join(ut.parse(t).dir,ut.parse(t).name)};var B=function(){};B.__name__=!0,B.getExStackThrownInfo=function(){var t="",e=V.toString(V.exceptionStack()),i=new f(".*/(.+) line (\\d+)","");return i.match(e.split("\n")[1])&&(t=i.matched(1)+":"+i.matched(2)),t};var H=function(){};H.__name__=!0,H.init=function(){H._isInited||(H._isInited=!0,H.messages=[])},H.end=function(){H.flag_socket_log&&H.io.close()},H.log=function(t,e,i){var r;null==e&&(e=1),e<H.logLevel||(r={pos:null,log:S.string(t),level:e},0<H.BUFFER_SIZE&&H.messages.length>=H.BUFFER_SIZE&&H.messages.shift(),H.messages.push(r),H.flag_socket_log&&H.io.sockets.emit("logText",{data:r.log,pos:r.pos,level:r.level}),null!=H.logFile&&H.push_File(r),null!=H.onLog&&H.onLog(r))},H.push_File=function(t){var e="";H.FLAG_SHOW_MESSAGE_TYPE&&(e+=H.messageTypes[t.level]+" "),e+=t.log+"\n";try{lt.appendFileSync(H.logFile,e,"utf8")}catch(t){if(Z.lastError=t,!(Y.caught(t).unwrap()instanceof Error))throw t;var i=l.TERMINAL.sprintf("~red~ - NO SPACE LEFT FOR THE LOG FILE - ~!~\n");process.stdout.write(i),process.exit(1)}};var q=function(){};q.__name__=!0,q.getGUID=function(){for(var t="",e=0;e<32;){var i=e++;8!=i&&12!=i&&16!=i&&20!=i||(t+="-"),t+=T.hex(Math.floor(16*Math.random()))}return t.toUpperCase()},q.bytesToMBStr=function(t){return S.string(Math.ceil(t/1048576))},q.padString=function(t,e,i){null==i&&(i="left");var r=e-t.length;if(0==r)return t;if(r<0)return t.substring(0,e-q.OVERFLOW_SMBL.length)+q.OVERFLOW_SMBL;switch(i){case"center":var n=Math.ceil(r/2),s=Math.floor(r/2);t=T.rpad(""," ",n)+t+T.rpad(""," ",s);break;case"left":t=T.rpad(t," ",e);break;case"right":t=T.lpad(t," ",e)}return t};var W=function(t,e){null==e&&(e=""),this.FLAG_ERRORS_ON_STDERR=!1,this.LOG_STDOUT=!0,this.LOG_STDERR=!0,this.exePath=ut.join(e,t)};W.__name__=!0,W.quickExec=function(t,r){ot.exec(t,function(t,e,i){r(null==t,e,i)})},W.quickExecS=function(t){try{return ot.execSync(t)}catch(t){return Z.lastError=t,null}},W.checkRun=function(t){try{ot.execSync(t,{timeout:1e4,stdio:"ignore"});return!0}catch(t){return Z.lastError=t,!1}},W.prototype={start:function(t,e){var s=this;null==t&&(t=[]),this.log_last_call=this.exePath+" "+t.join(" "),W.FLAG_LOG_QUIET||H.log("RUN: "+this.log_last_call),this.proc=ot.spawn(this.exePath,t,{cwd:e}),this.proc.once("error",function(t){s.kill(),s.ERROR="Exit Error : "+t.message,H.log("Process `"+s.exePath+"` [ ERROR ] - "+s.ERROR,3),null!=s.onClose&&s.onClose(!1)}),this.proc.once("close",function(t,e){var i,r,n;s.kill(),0!=t?(i=s.FLAG_ERRORS_ON_STDERR?s.stdErrLog:s.stdOutLog,r=new RegExp("(\\s\\s+|\n)","g".split("u").join("")),n=i.replace(r,""),s.ERROR="ExitCode:("+t+") , StdOut/Err:"+g.substr(n,-80,null),H.log("Process `"+s.exePath+"` End - [ ERROR ] - "+s.ERROR,3),null!=s.onClose&&s.onClose(!1)):(W.FLAG_LOG_QUIET||H.log("Process `"+s.exePath+"` End - [ OK ]"),null!=s.onClose&&s.onClose(!0))}),this.stdOutLog="",this.stdErrLog="",null!=this.onStdErr&&(this.proc.stderr.setEncoding("utf8"),this.proc.stderr.on("data",this.onStdErr)),null!=this.onStdOut&&(this.proc.stdout.setEncoding("utf8"),this.proc.stdout.on("data",this.onStdOut)),this.LOG_STDERR&&(this.proc.stderr.setEncoding("utf8"),this.proc.stderr.on("data",function(t){var e=s;return e.stdErrLog+=t,e.stdErrLog})),this.LOG_STDOUT&&(this.proc.stdout.setEncoding("utf8"),this.proc.stdout.on("data",function(t){var e=s;return e.stdOutLog+=t,e.stdOutLog}))},kill:function(){null!=this.proc&&(this.proc.removeAllListeners(),this.proc.kill(),this.proc=null)},exists:function(t){return null==t&&(t=""),W.checkRun(this.exePath+" "+t)}};var J=function(t){this.g_leftpad="",this.T=t,this.styles=[]};J.__name__=!0,J.prototype={style:function(t,e,i,r,n){this.styles[t]={fg:e,bg:i,l:r,r:n}},print1:function(t,s){var o=this,a=0,e=new f("\\{(-?\\d+):?(-?\\d+)?\\}","g"),l=[],i=!0;g.substr(t,-2,null)==J.NO_NEWLINE&&(t=g.substr(t,0,-2),i=!1);var r=e.map(t,function(t){var e=s[(a+=1)-1];null!=t.matched(2)&&(e=q.padString(e,S.parseInt(t.matched(2)))),l.push(e);var i=S.parseInt(t.matched(1));if(i<0)return e;var r,n=o.styles[i];try{r=o.T.COLORS_FG.h[n.fg]}catch(t){if(Z.lastError=t,Y.caught(t).unwrap()instanceof Error)return console.log("djNode/utils/Print2.hx:104:","print2() : Style Invalid Index ["+i+"]"),":INDEX_ERROR:";throw t}return null!=n.bg&&(r+=o.T.COLORS_BG.h[n.bg]),null!=n.l&&(r+=""+n.l),r+=e,null!=n.r&&(r+=""+n.r),r+="[0m",o.T.sprintf(r)}),n=(this.T,this.g_leftpad+r);process.stdout.write(n),i&&(this.T,process.stdout.write("\n"));var c=0;return e.map(t,function(t){return l[(c+=1)-1]})}};var Q=function(){};Q.__name__=!0,Q.print=function(t,e){var i,r=Math.ceil(t/100*e),n=T.lpad("",Q.SYMBOLS[0],r),s=T.rpad("",Q.SYMBOLS[1],t-r);null==Q.SYMBOLS[2]?(l.TERMINAL,process.stdout.write(""+n+s)):(l.TERMINAL,i=Q.SYMBOLS[2]+""+n+s+Q.SYMBOLS[3],process.stdout.write(i))},Q.draw=function(t,e,i,r){};var X=d["haxe.StackItem"]={__ename__:!0,__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:n},Module:((t=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:n}}).__params__=["m"],t),FilePos:((t=function(t,e,i,r){return{_hx_index:2,s:t,file:e,line:i,column:r,__enum__:"haxe.StackItem",toString:n}}).__params__=["s","file","line","column"],t),Method:((t=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:n}}).__params__=["classname","method"],t),LocalFunction:((t=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:n}}).__params__=["v"],t)},V={callStack:function(){return Z.toHaxe(Z.callStack())},exceptionStack:function(){var t=Z.toHaxe(Z.exceptionStack());return V.subtract(t,V.callStack())},toString:function(t){for(var e=new u,i=0,r=t;i<r.length;){var n=r[i];++i,e.b+="\nCalled from ",V.itemToString(e,n)}return e.b},subtract:function(t,e){for(var i=-1,r=-1;++r<t.length;){for(var n=0,s=e.length;n<s;){var o=n++;if(V.equalItems(t[r],e[o])){if(i<0&&(i=r),++r>=t.length)break}else i=-1}if(0<=i)break}return 0<=i?t.slice(0,i):t},equalItems:function(t,e){if(null==t)return null==e;switch(t._hx_index){case 0:return null!=e&&0==e._hx_index;case 1:return null!=e&&(1==e._hx_index&&t.m==e.m);case 2:if(null==e)return!1;if(2!=e._hx_index)return!1;var i=t.s,r=t.file,n=t.line,s=t.column,o=e.column,a=e.line,l=e.file,c=e.s;return r==l&&n==a&&s==o&&V.equalItems(i,c);case 3:if(null==e)return!1;if(3!=e._hx_index)return!1;var u=t.classname,h=t.method,p=e.method;return u==e.classname&&h==p;case 4:return null!=e&&(4==e._hx_index&&t.v==e.v)}},itemToString:function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var i=e.m;t.b+="module ",t.b+=null==i?"null":""+i;break;case 2:var r=e.column,n=e.line,s=e.file,o=e.s;null!=o&&(V.itemToString(t,o),t.b+=" ("),t.b+=null==s?"null":""+s,t.b+=" line ",t.b+=null==n?"null":""+n,null!=r&&(t.b+=" column ",t.b+=null==r?"null":""+r),null!=o&&(t.b+=")");break;case 3:var a=e.method,l=e.classname;t.b+=S.string(null==l?"<unknown>":l),t.b+=".",t.b+=null==a?"null":""+a;break;case 4:var c=e.v;t.b+="local function #",t.b+=null==c?"null":""+c}}},Y=function(t,e,i){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=i?i:this};Y.__name__=!0,Y.caught=function(t){return t instanceof Y?t:t instanceof Error?new Y(t.message,null,t):new tt(t,null,t)},Y.thrown=function(t){return t instanceof Y?t.get_native():t instanceof Error?t:new tt(t)},Y.__super__=Error,Y.prototype=e(Error.prototype,{unwrap:function(){return this.__nativeException},get_native:function(){return this.__nativeException},__properties__:{get_native:"get_native"}});var Z=function(){};Z.__name__=!0,Z.saveStack=function(t){Z.lastError=t},Z.callStack=function(){var t=new Error(""),e=Z.tryHaxeStack(t);if(void 0===e){try{throw t}catch(t){}e=t.stack}return Z.normalize(e,2)},Z.exceptionStack=function(){return Z.normalize(Z.tryHaxeStack(Z.lastError))},Z.toHaxe=function(t,e){if(null==e&&(e=0),null==t)return[];if("string"!=typeof t)return 0<e&&Array.isArray(t)?t.slice(e):t;var i=t.split("\n");"Error"==i[0]&&i.shift();for(var r=[],n=0,s=i.length;n<s;){var o,a,l,c,u,h,p,_=n++;_<e||(null!=(a=(o=i[_]).match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/))?("$hxClasses"==(l=a[1].split("."))[0]&&l.shift(),c=l.pop(),u=a[2],h=S.parseInt(a[3]),p=S.parseInt(a[4]),r.push(X.FilePos("Anonymous function"==c?X.LocalFunction():"Global code"==c?null:X.Method(l.join("."),c),u,h,p))):r.push(X.Module(T.trim(o))))}return r},Z.tryHaxeStack=function(t){if(null==t)return[];var e=Error.prepareStackTrace;Error.prepareStackTrace=Z.prepareHxStackTrace;var i=t.stack;return Error.prepareStackTrace=e,i},Z.prepareHxStackTrace=function(t,e){for(var i=[],r=0;r<e.length;){var n=e[r];++r,null!=Z.wrapCallSite&&(n=Z.wrapCallSite(n));var s,o,a,l=null,c=n.getFunctionName();null!=c&&(l=0<=(s=c.lastIndexOf("."))?(o=c.substring(0,s),a=c.substring(s+1),X.Method(o,a)):X.Method(null,c));var u=n.getFileName(),h=null==u?-1:u.indexOf("file:");null!=Z.wrapCallSite&&0<h&&(u=u.substring(h+6)),i.push(X.FilePos(l,u,n.getLineNumber(),n.getColumnNumber()))}return i},Z.normalize=function(t,e){if(null==e&&(e=0),Array.isArray(t)&&0<e)return t.slice(e);if("string"!=typeof t)return t;switch(t.substring(0,6)){case"Error\n":case"Error:":++e}return Z.skipLines(t,e)},Z.skipLines=function(t,e,i){return null==i&&(i=0),0<e?(i=t.indexOf("\n",i))<0?"":Z.skipLines(t,--e,i+1):t.substring(i)};var $=function(t){var e=this;this.id=setInterval(function(){e.run()},t)};$.__name__=!0,$.delay=function(t,e){var i=new $(e);return i.run=function(){i.stop(),t()},i},$.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){}};var tt=function(t,e,i){Y.call(this,String(t),e,i),this.value=t};tt.__name__=!0,tt.__super__=Y,tt.prototype=e(Y.prototype,{unwrap:function(){return this.value}});var et=function(){this.h=Object.create(null)};et.__name__=!0,et.keysIterator=function(t){var e=Object.keys(t),i=e.length,r=0;return{hasNext:function(){return r<i},next:function(){return e[(r+=1)-1]}}},et.kvIterator=function(e){var i=Object.keys(e),t=i.length,r=0;return{hasNext:function(){return r<t},next:function(){var t=i[(r+=1)-1];return{key:t,value:e[t]}}}};d["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};var it=function(){};it.__name__=!0,it.prototype={toString:function(){return"Eof"}};var rt=d["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:((t=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:n}}).__params__=["e"],t)},nt=function(t){switch(t){case".":case"..":return this.dir=t,void(this.file="")}var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");e<i?(this.dir=g.substr(t,0,i),t=g.substr(t,i+1,null),this.backslash=!0):i<e?(this.dir=g.substr(t,0,e),t=g.substr(t,e+1,null)):this.dir=null;var r=t.lastIndexOf(".");-1!=r?(this.ext=g.substr(t,r+1,null),this.file=g.substr(t,0,r)):(this.ext=null,this.file=t)};nt.__name__=!0,nt.directory=function(t){var e=new nt(t);return null==e.dir?"":e.dir},nt.extension=function(t){var e=new nt(t);return null==e.ext?"":e.ext},nt.join=function(t){for(var e=[],i=0,r=t;i<r.length;){var n=r[i];++i,null!=n&&""!=n&&e.push(n)}if(0==(t=e).length)return"";for(var s=t[0],e=1,i=t.length;e<i;){var o=e++,s=nt.addTrailingSlash(s);s+=t[o]}return nt.normalize(s)},nt.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,r=t.split("/");i<r.length;){var n=r[i];++i,".."==n&&0<e.length&&".."!=e[e.length-1]?e.pop():""==n?(0<e.length||47==g.cca(t,0))&&e.push(n):"."!=n&&e.push(n)}for(var s="",o=!1,a=!1,l=0,c=e.join("/");l<c.length;){var u=c,h=l++,p=u.charCodeAt(h);55296<=p&&p<=56319&&(p=p-55232<<10|1023&u.charCodeAt(1+h)),65536<=p&&++l;var _=p;switch(_){case 47:o?(o=!1,a&&(s+="/",a=!1),s+=String.fromCodePoint(_)):a=!0;break;case 58:s+=":",o=!0;break;default:o=!1,a&&(s+="/",a=!1),s+=String.fromCodePoint(_)}}return s},nt.addTrailingSlash=function(t){if(0==t.length)return"/";var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");return e<i?i!=t.length-1?t+"\\":t:e!=t.length-1?t+"/":t};var st=function(){};st.__name__=!0,st.__string_rec=function(n,s){if(null==n)return"null";if(5<=s.length)return"<...>";var t,e=typeof n;switch("function"==e&&(n.__name__||n.__ename__)&&(e="object"),e){case"function":return"<function>";case"object":if(n.__enum__){var i=d[n.__enum__],r=i.__constructs__[n._hx_index],o=i[r];return o.__params__?(s+="\t",r+"("+function(){for(var t=[],e=0,i=o.__params__;e<i.length;){var r=i[e];e+=1,t.push(st.__string_rec(n[r],s))}return t}().join(",")+")"):r}if(n instanceof Array){var a="[";s+="\t";for(var l=0,c=n.length;l<c;){var u=l++;a+=(0<u?",":"")+st.__string_rec(n[u],s)}return a+="]"}try{t=n.toString}catch(l){return Z.lastError=l,"???"}if(null!=t&&t!=Object.toString&&"function"==typeof t){var h=n.toString();if("[object Object]"!=h)return h}a="{\n";s+="\t";var p=null!=n.hasOwnProperty,_=null;for(_ in n)p&&!n.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=a.length&&(a+=", \n"),a+=s+_+" : "+st.__string_rec(n[_],s));return a+="\n"+(s=s.substring(1))+"}";case"string":return n;default:return String(n)}};var ot=require("child_process"),at=require("crypto"),lt=require("fs"),ct=require("os"),ut=require("path"),ht=require("events").EventEmitter,pt=require("buffer").Buffer,_t=function(){};_t.__name__=!0,_t.exists=function(t){try{return lt.accessSync(t),!0}catch(t){return Z.lastError=t,!1}};e(E.prototype,{readByte:function(){var t,e=pt.alloc(1);try{t=lt.readSync(this.fd,e,0,1,this.pos)}catch(t){Z.lastError=t;var i=Y.caught(t).unwrap();throw"EOF"==i.code?Y.thrown(new it):Y.thrown(rt.Custom(i))}if(0==t)throw Y.thrown(new it);return this.pos++,e[0]},readBytes:function(t,e,i){var r,n=t.b,s=pt.from(n.buffer,n.byteOffset,t.length);try{r=lt.readSync(this.fd,s,e,i,this.pos)}catch(t){Z.lastError=t;var o=Y.caught(t).unwrap();throw"EOF"==o.code?Y.thrown(new it):Y.thrown(rt.Custom(o))}if(0==r)throw Y.thrown(new it);return this.pos+=r,r},close:function(){lt.closeSync(this.fd)},seek:function(t,e){switch(e._hx_index){case 0:this.pos=t;break;case 1:this.pos+=t;break;case 2:this.pos=lt.fstatSync(this.fd).size+t}},tell:function(){return this.pos},eof:function(){return this.pos>=lt.fstatSync(this.fd).size}});e(h.prototype,{writeByte:function(t){var e=pt.alloc(1);e[0]=t,lt.writeSync(this.fd,e,0,1,this.pos),this.pos++},writeBytes:function(t,e,i){var r=t.b,n=pt.from(r.buffer,r.byteOffset,t.length),s=lt.writeSync(this.fd,n,e,i,this.pos);return this.pos+=s,s},close:function(){lt.closeSync(this.fd)},seek:function(t,e){switch(e._hx_index){case 0:this.pos=t;break;case 1:this.pos+=t;break;case 2:this.pos=lt.fstatSync(this.fd).size+t}},tell:function(){return this.pos}});var dt,ft;d["sys.io.FileSeek"]={__ename__:!0,__constructs__:["SeekBegin","SeekCur","SeekEnd"],SeekBegin:{_hx_index:0,__enum__:"sys.io.FileSeek",toString:n},SeekCur:{_hx_index:1,__enum__:"sys.io.FileSeek",toString:n},SeekEnd:{_hx_index:2,__enum__:"sys.io.FileSeek",toString:n}};function gt(t,e){return null==e?null:(null==e.__id__&&(e.__id__=r.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}r.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(g.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.__name__=!0,Array.__name__=!0,Date.__name__="Date",st.__toStr={}.toString,c.AUTHORNAME="John32B",c.PROGRAM_NAME="cdcrush",c.PROGRAM_VERSION="1.5.2",c.PROGRAM_SHORT_DESC="Highly compress cd-image games",c.LINK_DONATE="https://www.paypal.me/john32b",c.LINK_SOURCE="https://github.com/john32b/cdcrush",c.CDCRUSH_SETTINGS="crushdata.json",c.CDCRUSH_COVER="cover.jpg",c.CUE_EXTENSION=".cue",c.INFO_SUFFIX=" (cdcrush)",c.RESTORED_FOLDER_SUFFIX=" (r)",c.TEMP_FOLDER_NAME="CDCRUSH_361C4202-25A3-4F09-A690",c.FLAG_KEEP_TEMP=!1,c.MAX_TASKS=2,c.FLAG_NFO=!1,p.UPDATE_MIN_TIME=.16,p.PREFIX_HED="~yellow~>>~!.~ ",p.PREFIX_ONE="~cyan~==~!.~ ",p.PREFIX_TWO="~cyan~ >~!.~ ",p.PROGRESS_BAR_LEN=32,p.PROGRESS_BAR_COL="darkgreen",_.DEFAULT_AUDIO_PARAM="FLAC",_.DEFAULT_ARCHIVER_PARAM="ARC:1",_.arc=((dt=new et).h.ARC={name:"FreeArc",ext:".arc",cStr:["-s- -m3","-s- -m4","-s- -m5x"]},dt.h["7Z"]={name:"7-Zip",ext:".7z",cStr:["-t7z -ms=off -mx4","-t7z -ms=off -mx6","-t7z -ms=off -mx7"]},dt.h.ZIP={name:"Zip",ext:".zip",cStr:["-tzip -mx1","-tzip -mx6","-tzip -mx8"]},dt),_.audio=((ft=new et).h.MP3={name:"MP3",ext:".mp3",qReal:["9","7","5","1"],qName:["65","100","130","225"],p:"k Vbr",encstr:"-c:a libmp3lame -q:a "},ft.h.VORBIS={name:"Vorbis",ext:".ogg",qReal:["0","1.5","3","9"],qName:["64","88","112","320"],p:"k Vbr",encstr:"-c:a libvorbis -q "},ft.h.OPUS={name:"Opus",ext:".ogg",qReal:["48k","64k","96k","320k"],qName:["48","64","96","320"],p:"k Vbr",encstr:"-c:a libopus -vbr on -compression_level 10 -b:a "},ft.h.FLAC={name:"Flac Lossless",ext:".flac",qReal:null,qName:null,p:"",encstr:"-c:a flac"},ft.h.TAK={name:"Tak Lossless",ext:".tak",qReal:null,qName:null,p:"",encstr:""},ft),s.FLAG_LOG_TASKS=!0,k.UID=0,x.bin_ecm="ecm.exe",x.bin_unecm="unecm.exe",A.WIN32_EXE="ffmpeg.exe",F.WIN32_EXE="Arc.exe",C.S01=">update",C.WIN32_EXE="7za.exe",I.WIN32_EXE="Takc.exe",L.VERSION=4,L.NEWLINE="\n",L.SUPPORTED_TRACK_FILES=["BINARY","WAVE"],N.CTRLC="",N.ESC="",N.UP="[A",N.DOWN="[B",N.LEFT="[C",N.RIGHT="[D",N.BACKSP="\b",N.TAB="\t",N.ENTER="\r",N.DELETE="",M.FLAG_CAN_BREAK=!0,j.DEFAULT_LINE_WIDTH=50,j.DEFAULT_LINE_SYMBOL="-",H.messageTypes=["DEBUG","INFO","WARN","ERROR","FATAL"],H._isInited=!1,H.logLevel=0,H.flag_socket_log=!1,H.FLAG_SHOW_MESSAGE_TYPE=!1,H.BUFFER_SIZE=8e3,q.OVERFLOW_SMBL="-",W.FLAG_LOG_QUIET=!0,J.NO_NEWLINE="@n",Q.SYMBOLS=["#","-","[","]"],i.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);